<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="true" scan="true" scanPeriod="30 seconds">
	<contextName>Web Configuration</contextName>
	<jmxConfigurator />

<!-- 	<appender name="console" class="ch.qos.logback.core.ConsoleAppender"> -->
<!-- 		<encoder> -->
<!-- 			<pattern>%d{HH:mm:ss.SSS} [%-5level] %logger{36} [%file:%line] -%msg%n%ex</pattern> -->
<!-- 		</encoder> -->
<!-- 	</appender> -->


	<appender name="console" class="ch.qos.logback.core.ConsoleAppender">
		<filter class="ch.qos.logback.core.filter.EvaluatorFilter">
			<evaluator>
				<expression>return message.contains("/*NO_LOG*/");</expression>
			</evaluator>
			<OnMismatch>NEUTRAL</OnMismatch>
			<OnMatch>DENY</OnMatch>
		</filter>
		<layout class="ch.qos.logback.classic.PatternLayout">
			<pattern>[%d{HH:mm:ss.SSS}] [%thread] %-5level %logger{36}.%M %L | %msg%n%ex</pattern>
		</layout>
	</appender>

	<appender name="file" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>/data/log/enpem/enpem.log</file>
		<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<fileNamePattern>/data/log/enpem/old/enpem.%d{yyyy-MM-dd}.%i.log</fileNamePattern>
			<maxHistory>30</maxHistory>
			<timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
				<maxFileSize>50MB</maxFileSize>
			</timeBasedFileNamingAndTriggeringPolicy>
		</rollingPolicy>
		<filter class="ch.qos.logback.core.filter.EvaluatorFilter">
			<evaluator>
				<expression>return message.contains("/*NO_LOG*/");</expression>
			</evaluator>
			<OnMismatch>NEUTRAL</OnMismatch>
			<OnMatch>DENY</OnMatch>
		</filter>
		<encoder>
			<pattern>[%d{yyyy-MM-dd HH:mm:ss.SSS}] [%thread] %-5level %logger{36}.%M %L | %msg%n</pattern>
		</encoder>
	</appender>

	<appender name="batchFile" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>/data/log/enpem/batch.log</file>
		<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<fileNamePattern>/data/log/enpem/old/batch.%d{yyyy-MM-dd}.%i.log</fileNamePattern>
			<maxHistory>30</maxHistory>
			<timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
				<maxFileSize>50MB</maxFileSize>
			</timeBasedFileNamingAndTriggeringPolicy>
		</rollingPolicy>
		<encoder>
			<pattern>[%d{yyyy-MM-dd HH:mm:ss.SSS}] [%thread] %-5level %logger{36}.%M %L | %msg%n</pattern>
		</encoder>
	</appender>

	<logger name="org.springframework" level="WARN" />
	<logger name="org.springframework.security" level="INFO" />
	<logger name="org" level="ERROR" />
	<logger name="io" level="ERROR" />

	<logger name="java.sql.Connection" level="WARN" />
	<logger name="java.sql.Statement" level="WARN" />
	<logger name="java.sql.PreparedStatement" level="WARN" />
	<logger name="java.sql.ResultSet" level="WARN" />

	<logger name="jdbc.sqltiming" level="INFO" />
	<logger name="jdbc.audit" level="ERROR" />
	<logger name="jdbc.connection" level="ERROR" />
	<logger name="jdbc.sqlonly" level="ERROR" />
	<logger name="jdbc.resultset" level="ERROR" />
	<logger name="jdbc.resultsettable" level="DEBUG" />
<!-- 	<logger name="jdbc.sql" level="ERROR" />hone sql log -->
	<logger name="log4jdbc.debug" level="ERROR" />
<!-- 	<logger name="jdbc.sql.log" level="INFO" /> -->
<!-- 	<logger name="jdbc.resultset" level="DEBUG" /> -->

	<logger name="com.enpem.web.common.biz.BatchComp" level="DEBUG">
		<appender-ref ref="batchFile" />
	</logger>
	<logger name="com.enpem.web.common.biz.BatchService" level="DEBUG">
		<appender-ref ref="batchFile" />
	</logger>

	<root level="DEBUG">
		<appender-ref ref="console" />
		<appender-ref ref="file" />
	</root>

</configuration>