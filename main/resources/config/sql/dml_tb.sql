--메시지 임시 등록
/*
1	E100	업무오류(E)	사용자 정보가 존재하지 않습니다.
2	E101	업무오류(E)	로그인 세션이 존재하지 않습니다.
3	E102	업무오류(E)	첨부파일 등록이 실패하였습니다.
4	E103	업무오류(E)	첨부가능 파일수({0})를 초과했습니다.
5	E104	업무오류(E)	허용({0})되지 않은 첨부파일({1}) 형식입니다.
6	E105	업무오류(E)	첨부가능 용량({0})을 초과했습니다.
7	E106	업무오류(E)	해당 그룹코드에 상세코드가 존재합니다.
8	E107	업무오류(E)	{0} 존재하지 않습니다.
9	E108	업무오류(E)	해당 창고에 창고단말이 존재합니다.
10	E109	업무오류(E)	유효하지 않은 접근입니다.
11	E110	업무오류(E)	권한이 없습니다.
12	E111	업무오류(E)	잘못된 엑셀 파일입니다. {0}
13	F401	시스템에러(F)	UNAUTHORIZED
14	F403	시스템에러(F)	FORBIDDEN
15	F404	시스템에러(F)	NOT FOUND
16	F500	시스템에러(F)	오류입니다.
17	F501	시스템에러(F)	시스템 점검중 입니다.
18	F502	시스템에러(F)	세션이 만료 되었습니다.
19	F503	시스템에러(F)	중복된 데이터가 존재합니다.
20	F600	시스템에러(F)	연동 오류입니다.
21	S200	성공(S)	성공
 */

INSERT INTO TB_MSG(MSG_ID, INSERT_DT, INSERT_ID, MSG_TYPE, MSG_NM, MSG_DESC) VALUES
('F404', NOW(), 'SYSTEM', 'E', 'NOT FOUND', NULL),
('F500', NOW(), 'SYSTEM', 'E', '시스템오류', NULL),
('F600', NOW(), 'SYSTEM', 'E', '연동 오류', NULL),
('S200', NOW(), 'SYSTEM', 'E', '성공', NULL);

--사용자정보 마이그
INSERT INTO TB_USER(USER_ID, INSERT_ID, USE_YN, USER_NM, USER_PWD, AUTH_CD, CENTER_CD, AUTH_CENTER_CD, TEL_NO, HP_NO, FAX_NO, EMAIL, LAST_CON_DT)
SELECT USER_ID, 'SYSTEM', USE_YN, USER_NAME, USER_PWD, AUTH_CD, CENTER_CD, CENTER_CD, SUBSTRING(TEL_NO, 2, LEN(TEL_NO)), SUBSTRING(HP_NO, 2, LEN(HP_NO)), SUBSTRING(FAX_NO, 2, LEN(FAX_NO)), EMAIL, LOGIN_DATE FROM USER_INFO;

--사용자정보 권한 104->200으로 변경
UPDATE TB_USER SET AUTH_CD = '200' WHERE AUTH_CD = '104';

--그룹코드 마이그
INSERT INTO TB_GRP_CD(GRP_CD, INSERT_ID, USE_YN, GRP_NM, APL_STR_DD, APL_END_DD, GRP_DESC)
SELECT CODE_GROUP_CD, 'SYSTEM', USE_YN, CODE_GROUP_NM, '20180627', '99991231', CODE_DESC FROM CODE_GROUP;

--코드 마이그
INSERT INTO TB_CD(GRP_CD, CD, INSERT_ID, USE_YN, CD_NM, APL_STR_DD, APL_END_DD, CD_DESC, SEQ)
SELECT A.CODE_GROUP_CD, A.CODE_CD, 'SYSTEM', A.USE_YN, A.CODE_NAME, '20180627', '99991231', A.CODE_DESC, 1
FROM CODE_INFO A;

--그룹코드 등록
/*INSERT INTO TB_GRP_CD(GRP_CD, INSERT_ID, USE_YN, GRP_NM, APL_STR_DD, APL_END_DD, GRP_DESC) VALUES
('AUTH_CD', 'SYSTEM', 'Y', '사용자권한', '20180627', '99991231', '사용자별 권한'),
('FILE_DIV', 'SYSTEM', 'Y', '첨부파일구분', '20180627', '99991231', '첨부파일구분');*/

--코드 등록
/*INSERT INTO TB_CD(GRP_CD, CD, INSERT_ID, USE_YN, CD_NM, APL_STR_DD, APL_END_DD, SEQ) VALUES
 ('AUTH_CD', '100', 'SYSTEM', 'Y', '최고관리자', '20180627', '99991231', (SELECT COALESCE(MAX(SEQ), 0) + 1  FROM TB_CD WHERE GRP_CD = 'AUTH_CD'))
,('AUTH_CD', '104', 'SYSTEM', 'Y', '웹관리자', '20180627', '99991231', (SELECT COALESCE(MAX(SEQ), 0) + 1  FROM TB_CD WHERE GRP_CD = 'AUTH_CD'))
,('AUTH_CD', '300', 'SYSTEM', 'Y', '배송기사', '20180627', '99991231', (SELECT COALESCE(MAX(SEQ), 0) + 1  FROM TB_CD WHERE GRP_CD = 'AUTH_CD'))
,('AUTH_CD', '500', 'SYSTEM', 'Y', '현장관리자', '20180627', '99991231', (SELECT COALESCE(MAX(SEQ), 0) + 1  FROM TB_CD WHERE GRP_CD = 'AUTH_CD'))
,('FILE_DIV', 'NOTICE', 'SYSTEM', 'Y', '공지사항', '20180627', '99991231', (SELECT COALESCE(MAX(SEQ), 0) + 1  FROM TB_CD WHERE GRP_CD = 'FILE_DIV'))
,('FILE_DIV', 'QNA', 'SYSTEM', 'Y', '1대1문의', '20180627', '99991231', (SELECT COALESCE(MAX(SEQ), 0) + 1  FROM TB_CD WHERE GRP_CD = 'FILE_DIV'))
;*/


--사용자 소속정보 1인당 테이블로 분리 MIG
/*
INSERT INTO TB_USER_CENTER(USER_ID, CENTER_CD, INSERT_ID)
SELECT USER_ID, CENTER_CD, 'SYSTEM' FROM USER_INFO;
*/

--한종규(0001201) 테스트용 ROW
/*
INSERT INTO TB_USER_CENTER(USER_ID, CENTER_CD, INSERT_ID)
VALUES ('0001201', '1300', 'SYSTEM');
*/

--차량정보 마이그
INSERT INTO TB_CAR(CAR_ID, INSERT_ID, CAR_NO, CAR_TID, USE_YN, DTG_YN, DEV_YN
	, CENTER_CD, COMPANY_CD, WET_CD
	, CH_CNT, CH1_MIN, CH1_MAX, CH2_MIN, CH2_MAX, CH3_MIN, CH3_MAX, CH4_MIN, CH4_MAX
	, DRV_NM, DRV_TEL_NO, DRV_HP_NO, DRV_ZIP_NO, DRV_ADDR1, DRV_ADDR2)
SELECT VEHICLE_NUM, 'SYSTEM', VEHICLE_NO, SUBSTRING(PDA_NO, 2, LEN(PDA_NO)), USE_YN, CASE DTG_YN WHEN 0 THEN 'N' WHEN 1 THEN 'Y' END, 'N'
	, CENTER_CD, COMPANY_CD, WEGH_CD
	, TEMP_CHANNEL, FRONT_TEMP_MIN, FRONT_TEMP_MAX, REAR_TEMP_MIN, REAR_TEMP_MAX, 0, 0, 0, 0
	, DRIVER_NAME, SUBSTRING(DRIVER_TEL_NO, 2, LEN(DRIVER_TEL_NO)), SUBSTRING(DRIVER_HP_NO, 2, LEN(DRIVER_HP_NO)), DRIVER_ZIP_NO, DRIVER_ADDR1, DRIVER_ADDR2
FROM VEHICLE_INFO;

/*
--창고정보 마이그
INSERT INTO TB_CARGO(INSERT_ID, CARGO_NM, USE_YN, CENTER_CD, OLD_CARGO_ID)
SELECT 'SYSTEM', WAREHOUSE_NAME, USE_YN, CENTER_CD, WAREHOUSE_CD
FROM WAREHOUSE_INFO;
*/

--창고단말정보 마이그
/*
INSERT INTO TB_CARGO_DEV(DEV_ID, INSERT_ID, CARGO_ID, USE_YN, DEV_NM
	, CH_CNT, CH1_MIN, CH1_MAX, CH2_MIN, CH2_MAX, CH3_MIN, CH3_MAX, CH4_MIN, CH4_MAX, CH5_MIN, CH5_MAX, CH6_MIN, CH6_MAX)
SELECT SUBSTRING(A.PDA_NO, 2, LEN(A.PDA_NO)), 'SYSTEM', (SELECT CARGO_ID FROM TB_CARGO WHERE OLD_CARGO_ID = A.WAREHOUSE_CD), A.USE_YN, WAREHOUSE_NAME + ' 단말'
	, A.TEMP_CHANNEL, A.FRONT_TEMP_MIN, A.FRONT_TEMP_MAX, A.REAR_TEMP_MIN, A.REAR_TEMP_MAX, 0, 0, 0, 0, 0, 0, 0, 0
FROM WAREHOUSE_INFO A
WHERE A.PDA_NO NOT IN ('001000000000', '001041908329', '001041936143', '001045986187');
*/

--센터정보 마이그
INSERT INTO TB_CENTER(INSERT_ID, INSERT_DT, UPDATE_ID, UPDATE_DT, CENTER_CD, CENTER_NM, USE_YN, ZIP_CD, SI, GU, DONG, RI, S_BUNJI, E_BUNJI, STAFF_NM, STAFF_HP_NO, STAFF_TEL_NO)
SELECT REG_USER, REG_DT, MOD_USER, MOD_DT, CENTER_CD, CENTER_NAME, USE_YN, ZIP_CD, SI, GU, DONG, RI, S_BUNJI, E_BUNJI, STAF_NAME, STAF_HP_NO, STAF_TEL_NO FROM CENTER_INFO

--대리점정보 더미 테이블 드랍후 생성
DROP TABLE AGENT_INFO2;
SELECT * INTO AGENT_INFO2 FROM AGENT_INFO;

--대리점정보 제외센터 삭제
DELETE FROM AGENT_INFO2 WHERE CENTER_CD IN (' ', '1100', '1900', '2400', '2600', '2200');

--대리점 중복 제거
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000113' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000133' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000164' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000215' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000316' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000330' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000331' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000494' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000000602' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000001133' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000001243' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000001551' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000001567' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000001578' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000001686' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000001950' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000002030' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000002086' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000002111' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000002418' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000002464' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000002482' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000002500' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000003009' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000003068' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000003190' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000003272' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000004471' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000004558' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000005025' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000005833' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000005982' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000006736' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000007133' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000007135' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000007300' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000007420' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000007517' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008044' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008063' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008068' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008304' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008381' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008430' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008499' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008517' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008574' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008604' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008610' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008704' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008706' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008744' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008745' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008753' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000008757' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009234' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009239' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009245' AND CENTER_CD != '2300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009251' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009261' AND CENTER_CD != '2300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009286' AND CENTER_CD != '1300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009293' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009652' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009696' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009744' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009853' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009855' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009914' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009942' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009942' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009951' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009963' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000009971' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010002' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010075' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010086' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010119' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010144' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010158' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010207' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010223' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010274' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010275' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010305' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010307' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010316' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010368' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010378' AND CENTER_CD != '1300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010384' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010462' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010521' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010566' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010616' AND CENTER_CD != '1300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010619' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010664' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010691' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010710' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010726' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010727' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010789' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010822' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010832' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010841' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010852' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000010964' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011000' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011009' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011086' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011104' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011140' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011167' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011197' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011221' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011327' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011347' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011403' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011482' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011483' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011485' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011488' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011551' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011585' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011588' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011590' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011595' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011618' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011669' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011674' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011712' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011724' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011726' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011734' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011766' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011787' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011792' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011809' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011815' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011827' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011829' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011833' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011845' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011863' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011936' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011943' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011953' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011980' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000011995' AND CENTER_CD != '1300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012008' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012009' AND CENTER_CD != '3000';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012010' AND CENTER_CD != '3000';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012011' AND CENTER_CD != '3000';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012020' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012038' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012094' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012099' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012120' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012181' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012261' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012285' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012296' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012315' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012324' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012349' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012351' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012376' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012381' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012382' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012391' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012431' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012448' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012453' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012460' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012500' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012501' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012502' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012515' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012517' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012519' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012566' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012569' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012579' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012585' AND CENTER_CD != '2300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012586' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012704' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012717' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012806' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012819' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012825' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012872' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012889' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012899' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012913' AND CENTER_CD != '1300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012960' AND CENTER_CD != '3600';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012986' AND CENTER_CD != '3000';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000012988' AND CENTER_CD != '3000';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000013026' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000110685' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000300343' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000305978' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000305979' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000305981' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000306571' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000306574' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000308813' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000309355' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000309421' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000309453' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000309454' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000309533' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000309880' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000309915' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000309952' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000311714' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000314188' AND CENTER_CD != '1300';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000315343' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000315926' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000315994' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000316027' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000316137' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000316620' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000316649' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000316656' AND CENTER_CD != '1400';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000316743' AND CENTER_CD != '2700';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000316849' AND CENTER_CD != '1200';
DELETE FROM AGENT_INFO2 WHERE AGENT_CD = '0000317494' AND CENTER_CD != '2700';

--대리점정보 테이블 마이그
INSERT INTO TB_AGENT(AGENT_CD, INSERT_DT, INSERT_ID, UPDATE_DT, UPDATE_ID, AGENT_NM, USE_YN, CENTER_CD, EMP_NO, SI, GU, DONG, RI, S_BUNJI, E_BUNJI, STAFF_NM, STAFF_HP_NO, STAFF_TEL_NO, SO_CD)
SELECT AGENT_CD, CONVERT(DATETIME, REG_DT), REG_USER, CONVERT(DATETIME, MOD_DT), MOD_USER, AGENT_NAME, USE_YN, CENTER_CD, ZIP_CD, SI, GU, DONG, RI, S_BUNJI, E_BUNJI, STAF_NAME, SUBSTRING(STAF_HP_NO, 2, LEN(STAF_HP_NO)), SUBSTRING(STAF_TEL_NO, 2, LEN(STAF_TEL_NO)), BRANCH_CD FROM AGENT_INFO2

--대리점정보 더미테이블 삭제
DROP TABLE AGENT_INFO2;

--대리점위치정보 마이그
UPDATE TB_AGENT SET
	  CVO_ZIP = B.ZIP_CD
	, CVO_SI = B.SI
	, CVO_ADDR = B.ADDRESS
	, XPOS = B.LAT
	, YPOS = B.LNG
	--, CVO_NM = B.STAF_NAME
	, CVO_HP_NO = B.STAF_HP_NO
	, CVO_TEL_NO = B.STAF_TEL_NO
	--, PUSH_YN = CASE B.PUSH_STATE WHEN 0 THEN 'N' WHEN 1 THEN 'Y' END
	--, SHOW_YN = CASE B.VIEW_STATE WHEN 0 THEN 'N' WHEN 1 THEN 'Y' END
	, SAP_UPDATE_DT = CONVERT(DATETIME, B.MOD_DT)
FROM TB_AGENT A JOIN AGENT_GEO_INFO B
ON A.CENTER_CD = B.CENTER_CD AND A.AGENT_CD = B.AGENT_CD AND A.CENTER_CD NOT IN (' ', '1100', '1900', '2400', '2600', '2200');

--대리점 사용여부 'N'인 데이터 삭제
DELETE FROM TB_AGENT WHERE USE_YN ='N';

--중복 센터제외로 좌표값이 없는 대리점에 좌표값 삽입
UPDATE TB_AGENT SET
	  CVO_ZIP = B.ZIP_CD
	, CVO_SI = B.SI
	, CVO_ADDR = B.ADDRESS
	, XPOS = B.LAT
	, YPOS = B.LNG
	, CVO_HP_NO = B.STAF_HP_NO
	, CVO_TEL_NO = B.STAF_TEL_NO
	, SAP_UPDATE_DT = CONVERT(DATETIME, B.MOD_DT)
FROM DCVO_NEW.DBO.AGENT_GEO_INFO B
WHERE TB_AGENT.AGENT_CD = B.AGENT_CD
AND TB_AGENT.XPOS IS NULL

--대리점 사용자 추가
INSERT INTO TB_USER (
	  USER_ID
	, INSERT_ID
	, USE_YN
	, USER_NM
	, USER_PWD
	, AUTH_CD
	, CENTER_CD
	, AUTH_CENTER_CD
	, TEL_NO
	, HP_NO
	, FAX_NO
	, EMAIL
	, AGENT_CD
	, PUSH_YN
)
SELECT
	  'a' + REPLACE(LTRIM(REPLACE(AGENT_CD, '0', ' ')), ' ', '0')
	, 'SYSTEM'
	, 'Y'
	, STAFF_NM
	, SUBSTRING(MASTER.DBO.FN_VARBINTOHEXSTR(HASHBYTES('MD5', CONVERT(VARCHAR(MAX), '000000'))), 3, 32)
	, '600'
	, NULL
	, NULL
	, CVO_TEL_NO
	, CVO_HP_NO
	, NULL
	, NULL
	, AGENT_CD
	, 'N'
FROM TB_AGENT
WHERE USE_YN = 'Y';

--센터차량 알림수신자에 차량운전자의 USER_ID, USER_NM 일괄 등록
UPDATE TB_CAR SET
	  PUSH_IDS = (SELECT CASE WHEN ISNULL(USER_NM, '') = '' THEN NULL ELSE USER_ID END FROM TB_USER WHERE USER_ID = CAR_ID)
	, PUSH_NMS = (SELECT USER_NM FROM TB_USER WHERE USER_ID = CAR_ID)

/************************************* 테이블 이식 쿼리 *******************************************/

TRUNCATE TABLE TB_AGENT;
--TRUNCATE TABLE TB_AGENT_IO_LOG;
TRUNCATE TABLE TB_AUTH;
TRUNCATE TABLE TB_CAR;
TRUNCATE TABLE TB_CAR_EVENT;
TRUNCATE TABLE TB_CAR_REST;
--TRUNCATE TABLE TB_CAR_REST_LOG;
TRUNCATE TABLE TB_CAR_STAT;
TRUNCATE TABLE TB_CARGO_DEV;
TRUNCATE TABLE TB_CARGO_STAT;
TRUNCATE TABLE TB_CD;
TRUNCATE TABLE TB_CENTER;
--TRUNCATE TABLE TB_ERR_LOG;
--TRUNCATE TABLE TB_FILE;
TRUNCATE TABLE TB_GRP_CD;
TRUNCATE TABLE TB_MSG;
TRUNCATE TABLE TB_NOTICE;
--TRUNCATE TABLE TB_PKG;
--TRUNCATE TABLE TB_PKG_AGENT;
--TRUNCATE TABLE TB_PKG_ANAL;
TRUNCATE TABLE TB_QNA;
--TRUNCATE TABLE TB_SAP_IF_HIST;
TRUNCATE TABLE TB_SEQ;
TRUNCATE TABLE TB_USER;
--TRUNCATE TABLE TB_USER_HIST;


INSERT INTO TB_AGENT SELECT * FROM DCVO_NEW.DBO.TB_AGENT;
--INSERT INTO TB_AGENT_IO_LOG SELECT * FROM DCVO_NEW.DBO.TB_AGENT_IO_LOG;
INSERT INTO TB_AUTH SELECT * FROM DCVO_NEW.DBO.TB_AUTH;
INSERT INTO TB_CAR SELECT * FROM DCVO_NEW.DBO.TB_CAR;
INSERT INTO TB_CAR_EVENT SELECT * FROM DCVO_NEW.DBO.TB_CAR_EVENT;
INSERT INTO TB_CAR_REST SELECT * FROM DCVO_NEW.DBO.TB_CAR_REST;
--INSERT INTO TB_CAR_REST_LOG SELECT * FROM DCVO_NEW.DBO.TB_CAR_REST_LOG;
INSERT INTO TB_CAR_STAT SELECT * FROM DCVO_NEW.DBO.TB_CAR_STAT;
INSERT INTO TB_CARGO_DEV SELECT * FROM DCVO_NEW.DBO.TB_CARGO_DEV;
INSERT INTO TB_CARGO_STAT SELECT * FROM DCVO_NEW.DBO.TB_CARGO_STAT;
INSERT INTO TB_CD SELECT * FROM DCVO_NEW.DBO.TB_CD;
INSERT INTO TB_CENTER SELECT * FROM DCVO_NEW.DBO.TB_CENTER;
--INSERT INTO TB_ERR_LOG SELECT * FROM DCVO_NEW.DBO.TB_ERR_LOG;
--INSERT INTO TB_FILE SELECT * FROM DCVO_NEW.DBO.TB_FILE;
INSERT INTO TB_GRP_CD SELECT * FROM DCVO_NEW.DBO.TB_GRP_CD;
INSERT INTO TB_MSG SELECT * FROM DCVO_NEW.DBO.TB_MSG;
INSERT INTO TB_NOTICE SELECT * FROM DCVO_NEW.DBO.TB_NOTICE;
--INSERT INTO TB_PKG SELECT * FROM DCVO_NEW.DBO.TB_PKG;
--INSERT INTO TB_PKG_AGENT SELECT * FROM DCVO_NEW.DBO.TB_PKG_AGENT;
--INSERT INTO TB_PKG_ANAL SELECT * FROM DCVO_NEW.DBO.TB_PKG_ANAL;
INSERT INTO TB_QNA SELECT * FROM DCVO_NEW.DBO.TB_QNA;
--INSERT INTO TB_SAP_IF_HIST SELECT * FROM DCVO_NEW.DBO.TB_SAP_IF_HIST;
SET IDENTITY_INSERT TB_SEQ ON;
INSERT INTO TB_SEQ (SEQ, INSERT_DT, INSERT_ID, UPDATE_DT, UPDATE_ID, TABLE_NM, COLUMN_NM, PREFIX, NOW_SEQ)
SELECT SEQ, INSERT_DT, INSERT_ID, UPDATE_DT, UPDATE_ID, TABLE_NM, COLUMN_NM, PREFIX, NOW_SEQ FROM DCVO_NEW.DBO.TB_SEQ;
SET IDENTITY_INSERT TB_SEQ OFF;
INSERT INTO TB_USER SELECT * FROM DCVO_NEW.DBO.TB_USER;
--INSERT INTO TB_USER_HIST SELECT * FROM DCVO_NEW.DBO.TB_USER_HIST;

TRUNCATE TABLE TB_CAR_HIST;
SET IDENTITY_INSERT TB_CAR_HIST ON;
INSERT INTO TB_CAR_HIST (SEQ, INSERT_DT, INSERT_ID, UPDATE_DT, UPDATE_ID, CAR_ID, USE_YN, LOG_DIV, XPOS, YPOS, DAY_TOT_DIS,TURN_YN, SPD, CH1, CH2, CH3, CH4, DEV_DT, JIBUN_ADDR, ROAD_ADDR)
SELECT SEQ, INSERT_DT, INSERT_ID, UPDATE_DT, UPDATE_ID, CAR_ID, USE_YN, LOG_DIV, XPOS, YPOS, DAY_TOT_DIS,TURN_YN, SPD, CH1, CH2, CH3, CH4, DEV_DT, JIBUN_ADDR, ROAD_ADDR FROM DCVO_NEW.DBO.TB_CAR_HIST WHERE DEV_DT >=  CONVERT(DATETIME, '20181001', 112);
SET IDENTITY_INSERT TB_CAR_HIST OFF;
TRUNCATE TABLE TB_CARGO_HIST;
SET IDENTITY_INSERT TB_CARGO_HIST ON;
INSERT INTO TB_CARGO_HIST (SEQ, INSERT_DT, INSERT_ID, UPDATE_DT, UPDATE_ID, DEV_ID, USE_YN, TID, CH1, CH2, CH3, CH4, CH5, CH6, DEV_DT, SVR_DT)
SELECT SEQ, INSERT_DT, INSERT_ID, UPDATE_DT, UPDATE_ID, DEV_ID, USE_YN, TID, CH1, CH2, CH3, CH4, CH5, CH6, DEV_DT, SVR_DT FROM DCVO_NEW.DBO.TB_CARGO_HIST WHERE DEV_DT >=  CONVERT(DATETIME, '20181001', 112);
SET IDENTITY_INSERT TB_CARGO_HIST OFF;


--SELECT A.COLUMN_NAME + ',' FROM INFORMATION_SCHEMA.COLUMNS A WHERE A.TABLE_NAME = 'TB_SEQ'
