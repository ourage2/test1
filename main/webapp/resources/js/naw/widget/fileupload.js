(function(B){naw.namespace("widget.fileupload");var C=naw.agent.browser;naw.widget.fileupload=naw.widget.Base.extend({init:function(a,d){this.setName("fileupload");this._super();this.upload_number=1;var b=this._getTemplate(a);b.renderTo=d.id;this.renderTo=b.renderTo?b.renderTo:null;this.fileExt=b.fileExt?b.fileExt:naw.config.uploadFileExt;this.fileCount=b.fileCount?0>b.fileCount?5:b.fileCount:5;this.uploadId=b.nodeId?b.nodeId:b.uploadId?b.uploadId:"fileattach";this.uploadSubPath=b.uploadSubPath?b.uploadSubPath:
null;this.saveFName=b.saveFName?b.saveFName:null;this.filePrefix=b.filePrefix?b.filePrefix:null;this.callBackFunction=b.callBackFunction?b.callBackFunction:null;this.beforeFunction=b.beforeFunction?b.beforeFunction:null;this.deleteFileFunction=b.deleteFileFunction?b.deleteFileFunction:null;this.fileSelectFunction=b.fileSelectFunction?b.fileSelectFunction:null;this.drm="undefined"!=typeof b.drm?b.drm:B.config.drmOptions.upload;this.fileSelection="msie"==C&&10>parseInt(naw.agent.version)?"single":"multi";
this.directUpload=naw.isNull(b.directUpload)?!1:b.directUpload;this.simpleUpload=naw.isNull(b.simpleUpload)?!1:b.simpleUpload;this.btnName=naw.isNull(b.btnName)?"파일업로드":""==b.btnName?"파일업로드":b.btnName;this.height=naw.isNull(b.height)?122:""==b.height?122:parseInt(b.height);this.submitFileList=[];this.simpleUploadSubmit=naw.isNull(b.simpleUploadSubmit)?!0:b.simpleUploadSubmit;this.uploadBtn=naw.isNull(b.uploadBtn)?!0:b.uploadBtn;this.submitMsgShow=naw.isNull(b.submitMsgShow)?!0:b.submitMsgShow;this.maxFileSize=
naw.isNull(b.maxFileSize)?naw.config.maxUploadSize:1024*naw.toInt(b.maxFileSize);this._create()},_create:function(){var a=this;naw.subscribe("theme.change",function(b){a.changeTheme(b.themeName,b.themeBasePath)});var d="";this.simpleUpload?(d="multi"==this.fileSelection?d+('<button class="doaction" id="'+this.renderTo+'_add">'+a.btnName+"</button>"):d+('<label for="'+this.renderTo+"_input"+a.upload_number+'" class="dofile" id="'+this.renderTo+'_add">'+a.btnName+"</label>"),d=d+'<div class="empty-pnl state-hide">'+
('<button class="doaction state-hide" id="'+this.renderTo+'_up">파일전송</button>'),d=d+'<span class="file-drag-text">Drag & Drop Files</span><div class="file-ext fr">'+('<span class="file-progressbar" id="'+this.renderTo+'_progress"><span class="file-progress" id="'+this.renderTo+'_progressbar"></span></span>'),d+='<span class="file-size" id="'+this.renderTo+'_maxSize">0KB / '+this.maxFileSize/1024+"MB</span>",d=d+"</div></div>"+('<div id="'+this.renderTo+'_tablediv" class="table-pnl fileupload-table-pnl state-hide">')):
(d+='<div class="empty-pnl">',d="multi"==this.fileSelection?d+('<button class="doaction" id="'+this.renderTo+'_add">파일추가</button>'):this.simpleUpload?d+('<label for="'+this.renderTo+"_input"+a.upload_number+'" class="dofile" id="'+this.renderTo+'_add">'+a.btnName+"</label>"):d+('<label for="'+this.renderTo+"_input"+a.upload_number+'" class="dofile" id="'+this.renderTo+'_add">파일추가</label>'),this.directUpload||this.uploadBtn&&(d+='<button class="doaction" id="'+this.renderTo+'_up">파일전송</button>'),"multi"==
this.fileSelection&&"chrome"!=naw.agent.browser&&(d+='<span class="file-drag-text">Drag & Drop Files</span>'),d=d+'<div class="file-ext fr">'+('<span class="file-progressbar" id="'+this.renderTo+'_progress"><span class="file-progress" id="'+this.renderTo+'_progressbar"></span></span>'),"multi"==this.fileSelection&&(d+='<span class="file-size" id="'+this.renderTo+'_maxSize">0KB / '+this.maxFileSize/1024+"MB</span>"),d=d+"</div></div>"+('<div id="'+this.renderTo+'_tablediv" class="table-pnl fileupload-table-pnl">'));
d+='<table id="'+this.renderTo+'_table_header">';d=d+'<colgroup><col width="35%"><col width="10%"><col width="55%"><col width="0%"><col width="0%"></colgroup><tr class="fileupload-header-tr"><td class="fileupload-header-td">파일명</td><td class="fileupload-header-td">종류</td><td class="fileupload-header-td">상태 / 저장명 / 크기</td><td></td><td></td></tr></table>'+('<div id="'+this.renderTo+'_intablediv" class="fileuploadlist-table-pnl">');d+='<table id="'+this.renderTo+'_table">';d=d+'<colgroup><col width="35%"><col width="10%"><col width="55%"><col width="0%"><col width="0%"></colgroup></table></div></div>'+
('<form id="'+this.renderTo+'_form" name="'+this.renderTo+'_form" method="post" enctype="multipart/form-data">');d+='<span id="'+this.renderTo+'_more">';d+="</span></form>";jQuery("#"+this.renderTo).html(d);jQuery("#"+this.renderTo+"_intablediv").css({height:this.height-32,"overflow-x":"hidden","overflow-y":"auto"});jQuery("#"+this.renderTo).on("dragenter",function(b){if("chrome"!=naw.agent.browser){b.stopPropagation();b.preventDefault();if(a.simpleUpload)return!1;"multi"==a.fileSelection&&jQuery(this).addClass("file-drag")}});
jQuery("#"+this.renderTo).on("dragover",function(b){if("chrome"!=naw.agent.browser){b.stopPropagation();b.preventDefault();if(a.simpleUpload)return!1;"multi"==a.fileSelection&&jQuery(this).addClass("file-drag")}});jQuery("#"+this.renderTo).on("dragleave",function(b){if("chrome"!=naw.agent.browser){b.stopPropagation();b.preventDefault();if(a.simpleUpload)return!1;"multi"==a.fileSelection&&jQuery(this).removeClass("file-drag")}});jQuery("#"+this.renderTo).on("drop",function(e){if("chrome"!=naw.agent.browser){e.preventDefault();
if(a.simpleUpload)return!1;"multi"==a.fileSelection?(jQuery(this).removeClass("file-drag"),e=e.originalEvent.dataTransfer.files,"multi"==a.fileSelection&&b(e)):naw.showSlideMessage("IE9 이하 버전에서는 drag & drop 기능을 사용 할 수 없습니다.",3E3)}});jQuery(document).on("dragenter",function(a){"chrome"!=naw.agent.browser&&(a.stopPropagation(),a.preventDefault())});jQuery(document).on("dragover",function(a){"chrome"!=naw.agent.browser&&(a.stopPropagation(),a.preventDefault())});jQuery(document).on("drop",function(a){"chrome"!=
naw.agent.browser&&(a.stopPropagation(),a.preventDefault())});jQuery("#"+this.renderTo+"_up").bind("click",function(){if(0>=jQuery("#"+a.renderTo+"_table")[0].rows.length||"multi"==a.fileSelection&&0==a.submitFileList.length)return naw.showSlideMessage(naw.getMessage("W0107"),3E3),!1;if(a.beforeFunction&&!a.beforeFunction.call())return!1;a._fileuploadStream(a.uploadId,a.uploadSubPath,a.filePrefix,a.drm,a.saveFName)});jQuery("#"+this.renderTo+"_add").bind("click",function(){if("multi"==a.fileSelection){1==
jQuery("#"+a.renderTo+"_input").length&&"none"==jQuery("#"+a.renderTo+"_input").css("display")&&jQuery("#"+a.renderTo+"_input").remove();if(a.fileCount==a.submitFileList.length){naw.showSlideMessage(naw.getMessage("W0108"),3E3);return}jQuery("<input class='state-hide' type='file' multiple name='"+a.renderTo+"_input' id='"+a.renderTo+"_input'>").appendTo("#"+a.renderTo+"_more");jQuery("#"+a.renderTo+"_input").bind("change",function(){b()});jQuery("#"+a.renderTo+"_input").click()}else{if(1<a.upload_number){var d=
a.upload_number-1;if("none"!=jQuery("#"+a.renderTo+"_input"+d).css("display"))return naw.showSlideMessage(naw.getMessage("W0110"),3E3),!1;"none"==jQuery("#"+a.renderTo+"_input"+d).css("display")&&""==jQuery("#"+a.renderTo+"_input"+d)[0].value&&(jQuery("#"+a.renderTo+"_input"+d).remove(),a.upload_number--)}jQuery("<input class='state-hide' type='file' name='"+a.renderTo+"_input"+a.upload_number+"' id='"+a.renderTo+"_input"+a.upload_number+"' >").appendTo("#"+a.renderTo+"_more");jQuery("#"+a.renderTo+
"_input"+a.upload_number).bind("change",function(){var b=a.upload_number-1;if(1<b)for(var d=1;d<b;d++)if(jQuery("#"+a.renderTo+"_input"+d)[0].value==jQuery(this)[0].value){naw.showSlideMessage(naw.getMessage("W0109"),3E3);jQuery(this).remove();a.upload_number--;return}e(b)})}a.upload_number++});var b=function(b){b=naw.isNull(b)?jQuery("#"+a.renderTo+"_input")[0].files:b;var e=jQuery("#"+a.renderTo+"_table")[0],d=e.rows.length,c="",g="";if(a.fileCount<a.submitFileList.length+b.length)return naw.showSlideMessage(naw.getMessage("W0108")+
"(최대 "+a.fileCount+"건 까지 전송가능합니다)",3E3),jQuery("#"+a.renderTo+"_input").remove(),!1;for(var g=!0,m=[],c=0,q=[],t=[],f=0;f<b.length;f++){c+=b[f].size;q[f]=b[f].name;var v=q[f].lastIndexOf(".");q[f]=q[f].substr(0,v);t[f]=b[f].name.substring(v+1);v=!1;if(a.fileExt)for(var u=0;u<a.fileExt.length;u++){if(a.fileExt[u]==t[f].toLowerCase()){v=!0;break}}else v=!0;if(!t[f].toLowerCase()||!v){naw.showSlideMessage(naw.getMessage("W0106")+" 첨부 가능 파일: "+a.fileExt,3E3);jQuery("#"+a.renderTo+"_input").remove();g=
!1;break}m[f]=b[f].name;if(0<d&&g)for(u=0;u<d;u++)if(v=jQuery(e.rows[u].cells[0].childNodes[0]).html()+"."+jQuery(e.rows[u].cells[1]).html(),-1!=v.indexOf(b[f].name)){naw.showSlideMessage(naw.getMessage("W0109"),3E3);jQuery("#"+a.renderTo+"_input").remove();g=!1;break}}if(!g)return!1;for(f=g=0;f<a.submitFileList.length;f++)g+=a.submitFileList[f].size;if(1024*a.maxFileSize<c+g)return naw.showSlideMessage("첨부 가능한 파일 용량을 초과 하였습니다.",3E3),!1;f=naw.round((c+g)/1024,2);f=1024<f?naw.round(f/1024,2)+"MB":
f+"KB";jQuery("#"+a.renderTo+"_maxSize").text(f+" / "+a.maxFileSize/1024+"MB");for(f=0;f<b.length;f++)a.submitFileList[a.submitFileList.length]=b[f],c=m[f],-1!=c.indexOf(".")&&(c=c.split(".")[0]),c=e.insertRow(d),jQuery(c).addClass("fileupload-body-tr"),g=c.insertCell(0),jQuery(g).addClass("fileupload-body-td"),jQuery(g).html("<span id='"+a.renderTo+"_name_"+q[f]+"_"+t[f]+"'>"+q[f]+"</span>&nbsp;<span class='fileupload-cancel-button' id='"+a.renderTo+"_cancel'>&nbsp</span>"),g=c.insertCell(1),jQuery(g).addClass("fileupload-body-td"),
jQuery(g).html(t[f]),g=c.insertCell(2),jQuery(g).addClass("fileupload-body-td"),g=c.insertCell(3),jQuery(g).addClass("fileupload-body-td"),g=c.insertCell(4),jQuery(g).addClass("fileupload-body-td");jQuery("#"+a.renderTo+"_cancel.fileupload-cancel-button").unbind("click");jQuery("#"+a.renderTo+"_cancel.fileupload-cancel-button").bind("click",function(c){var b=jQuery(this).parent().parent().index(),f=jQuery("#"+a.renderTo+"_table")[0];if(""==jQuery(f.rows[b].cells[2]).html()){for(f=b=0;f<a.submitFileList.length;f++){var q=
a.submitFileList[f].name,e=q.lastIndexOf("."),q=q.substr(0,e);jQuery(c.target).prev().text()==q&&a.submitFileList.splice(f,1)}for(f=0;f<a.submitFileList.length;f++)b+=a.submitFileList[f].size;jQuery(this).parent().parent().fadeOut(500,function(){jQuery(this).remove()});b=naw.round(b/1024,2);b=1024<b?naw.round(b/1024,2)+"MB":b+"KB";jQuery("#"+a.renderTo+"_maxSize").text(b+" / "+a.maxFileSize/1024+"MB")}else jQuery(this).parent().parent().fadeOut(500,function(){jQuery(this).remove()})});jQuery("#"+
a.renderTo+"_input").remove();jQuery("#"+a.renderTo+"_progressbar").css("width","0%");null!=a.fileSelectFunction&&a.fileSelectFunction.call("",q,t,a.renderTo,"");setTimeout(function(){a.simpleUpload?a.simpleUploadSubmit&&a.fileSubmit():a.directUpload&&a.fileSubmit()},1)},e=function(b){var e=jQuery("#"+a.renderTo+"_table")[0],d=e.rows.length,c="",g="",m=jQuery("#"+a.renderTo+"_input"+b)[0].value,q=m.lastIndexOf("\\")+1,m=m.substring(q),c=m.lastIndexOf("."),q=m.lastIndexOf(".")+1,q=m.substring(q),m=
m.substr(0,c),c=!1;if(a.fileExt)for(g=0;g<a.fileExt.length;g++){if(a.fileExt[g]==q.toLowerCase()){c=!0;break}}else c=!0;if(!q.toLowerCase()||!c)return naw.showSlideMessage(naw.getMessage("W0106")+" 첨부 가능 파일: "+a.fileExt,3E3),jQuery("#"+a.renderTo+"_input"+b).remove(),a.upload_number--,!1;c=e.insertRow(d);jQuery(c).addClass("fileupload-body-tr");g=c.insertCell(0);jQuery(g).addClass("fileupload-body-td");jQuery(g).html("<span id='"+a.renderTo+"_name"+b+"'>"+m+"</span>&nbsp;<span class='fileupload-cancel-button' id='"+
a.renderTo+"_cancel'>&nbsp</span>");g=c.insertCell(1);jQuery(g).addClass("fileupload-body-td");jQuery(g).html(q);g=c.insertCell(2);jQuery(g).addClass("fileupload-body-td");g=c.insertCell(3);jQuery(g).addClass("fileupload-body-td");g=c.insertCell(4);jQuery(g).addClass("fileupload-body-td");jQuery("#"+a.renderTo+"_progressbar").css("width","0%");jQuery("#"+a.renderTo+"_cancel.fileupload-cancel-button").unbind("click");jQuery("#"+a.renderTo+"_cancel.fileupload-cancel-button").bind("click",function(c){c=
jQuery(c.target.parentNode.parentNode).index();var b=jQuery("#"+a.renderTo+"_table")[0];if(""==jQuery(b.rows[c].cells[2]).html()){jQuery("#"+a.renderTo+"_input"+(c+1)).remove();a.upload_number--;c=jQuery("#"+a.renderTo+"_more").find("input");for(b=0;b<c.length;b++)c[b].id=a.renderTo+"_input"+(b+1),c[b].name=a.renderTo+"_input"+(b+1);jQuery(this).parent().parent().fadeOut(500,function(){jQuery(this).remove()});jQuery("#"+a.renderTo+"_add").attr("for",a.renderTo+"_input"+(jQuery("#"+a.renderTo+"_more").find("input").length+
1))}else jQuery(this).parent().parent().fadeOut(500,function(){jQuery(this).remove()})});null!=a.fileSelectFunction&&a.fileSelectFunction.call("",m,q,a.renderTo,"");a.simpleUpload||a.directUpload?setTimeout(function(){(a.simpleUpload||a.directUpload)&&a.fileSubmit()},1):jQuery("#"+a.renderTo+"_add").attr("for",a.renderTo+"_input"+(b+1))}},setSubPath:function(a){return this.uploadSubPath=a},getSubPath:function(){return this.uploadSubPath},setMaxFileCount:function(a){return this.fileCount=a},getMaxFileCount:function(){return this.fileCount},
getFileCount:function(){if("multi"==this.fileSelection)return this.submitFileList.length;for(var a=jQuery("#"+this.renderTo+"_more").find("input"),d=0,b=0;b<a.length;b++)""!=a[b].value&&d++;return d},fileClear:function(){"multi"==this.fileSelection?this.submitFileList=[]:jQuery("#"+this.renderTo+"_more").find("input").remove();jQuery("#"+this.renderTo+"_table").html("");jQuery("#"+this.renderTo+"_progressbar").css("width","0%");jQuery("#"+this.renderTo+"_maxSize").text("0KB / "+this.maxFileSize/1024+
"MB");this.upload_number=1},fileSubmit:function(){if(0>=jQuery("#"+this.renderTo+"_table")[0].rows.length||"multi"==this.fileSelection&&0==this.submitFileList.length)return naw.showSlideMessage(naw.getMessage("W0107"),3E3),!1;if(this.beforeFunction&&!this.beforeFunction.call())return!1;this._fileuploadStream(this.uploadId,this.uploadSubPath,this.preFix,this.drm,this.saveFName)},deleteFileList:function(a){var d=!1;if("multi"==this.fileSelection){for(var b=0;b<a.length;b++){for(var e=jQuery("#"+this.renderTo+
"_table")[0],l=e=0;l<this.submitFileList.length;l++)a[b]==this.submitFileList[l].name&&(this.submitFileList.splice(l,1),d=!0);for(l=0;l<this.submitFileList.length;l++)e+=this.submitFileList[l].size;var l=a[b],h=l.lastIndexOf("."),p=l.substr(h+1),l=l.substr(0,h);jQuery("#"+this.renderTo+"_name_"+l+"_"+p).parent().parent().fadeOut(500,function(){jQuery(this).remove()})}e=naw.round(e/1024,2);e=1024<e?naw.round(e/1024,2)+"MB":e+"KB";jQuery("#"+this.renderTo+"_maxSize").text(e+" / "+this.maxFileSize/1024+
"MB")}else{e=jQuery("#"+this.renderTo+"_table")[0];h=e.rows.length;for(l=0;l<a.length;l++)for(b=0;b<h;b++)p=jQuery(jQuery(e.rows[b].cells[0]).find("span")[0]).html()+"."+jQuery(e.rows[b].cells[1]).html(),a[l]==p&&jQuery(e.rows[b]).fadeOut(500,function(){jQuery(this).remove()});for(l=0;l<a.length;l++){e=jQuery("#"+this.renderTo+"_more").find("input");for(b=0;b<e.length;b++)-1!=e[b].value.indexOf(a[l])&&(jQuery("#"+this.renderTo+"_input"+(b+1)).remove(),this.upload_number--,d=!0);e=jQuery("#"+this.renderTo+
"_more").find("input");for(b=0;b<e.length;b++)e[b].id=this.renderTo+"_input"+(b+1),e[b].name=this.renderTo+"_input"+(b+1);jQuery("#"+this.renderTo+"_add").attr("for",this.renderTo+"_input"+(jQuery("#"+this.renderTo+"_more").find("input").length+1))}}d&&naw.showSlideMessage("첨부 파일이 삭제 되었습니다.",3E3);return d},deleteFile:function(a,d){jQuery.ajax({type:"post",url:naw.config.servletURI.upload+"?upload_id="+this.uploadId,data:{funCd:"delete",delFList:a.join("\b")},async:!1,cache:!1,success:function(a){try{var b=
a.split("|"),l=b[1],h=naw.convertObject(b[2]);if("DELETE OK!!!"==l)return naw.showSlideMessage("정상적으로 삭제 되었습니다.",3E3),!1;if("DELETE FAIL!!!"==l)return naw.showSlideMessage("파일 삭제 시 오류가 발생하였습니다. 확인 후 재전송 하십시오.",3E3),!1;"undefined"!=typeof d&&d.call("",h);return h}catch(p){return alert(p.description),!1}},error:function(){alert("error")}})},setSaveFName:function(a){this.saveFName=a;return!0},_upload:function(a,d,b){if(a&&d){naw._showAccessDeny();var e=this,l=this.renderTo;if("multi"==e.fileSelection){var h=
new FormData;b=jQuery("#"+l+"_table")[0];for(var p=0;p<b.rows.length;p++)jQuery(b.rows[p].cells[0].childNodes[0]).html();for(p=0;p<e.submitFileList.length;p++)h.append("uploadfile"+p,e.submitFileList[p]);d="string"==typeof d?d:jQuery.param(d);jQuery.each(d.split("&"),function(){var a=this.split("=");h.append(a[0],a[1])});jQuery.ajax({url:a,type:"POST",data:h,async:!0,cache:!1,contentType:!1,processData:!1,xhr:function(){var a=new window.XMLHttpRequest;a.upload.addEventListener("progress",function(a){a.lengthComputable&&
(a=parseInt(a.loaded/a.total*100),jQuery("#"+e.renderTo+"_progressbar").css("width",a+"%"))},!1);return a},beforeSend:function(a){},success:function(a,c,b){naw._hideAccessDeny();c=jQuery.trim(c);if("success"==c){c=[];b=[];var f=[],g=[],q=[],d=jQuery.trim(a).replace(/&amp;/g,"&").split("|");a=d[0];-1!=a.indexOf(">")&&(a=a.split(">")[1]);if("0000"==a){var d=naw.convertObject(d[2]),m;for(m in d)c[m]=d[m].fname,b[m]=d[m].fsavename,f[m]=d[m].fext,g[m]=d[m].fsize,q[m]=d[m].fpath;for(var d=jQuery("#"+l+
"_table")[0],t=[],h=0;h<d.rows.length;h++)if(""==jQuery(d.rows[h].cells[2]).html()){m=jQuery(d.rows[h].cells[0].childNodes[0]).html()+"."+jQuery(d.rows[h].cells[1]).html();t[h-1]={};for(var p=0;p<c.length;p++)-1!=m.indexOf(c[p]+"."+f[p])&&(t[h-1].cell2="OK / "+b[p]+"."+f[p]+" / "+g[p]+"byte",t[h-1].cell3=b[p]+"."+f[p],t[h-1].cell4=q[p]);jQuery(d.rows[h].cells[2]).html(t[h-1].cell2)}e.submitMsgShow&&naw.showSlideMessage(naw.getMessage("W0111"),3E3);e.callBackFunction.call("",a,c,b,f,g,q,e.renderTo);
jQuery("#"+e.renderTo+"_maxSize").text("0KB / "+e.maxFileSize/1024+"MB");e.submitFileList=[]}else""!=d[1]?-1==d[1].indexOf("permitted")?e.submitMsgShow&&naw.showSlideMessage("fileupload : "+a+":"+d[1],3E3):e.submitMsgShow&&naw.showSlideMessage(naw.getMessage("W0113"),3E3):e.submitMsgShow&&naw.showSlideMessage(naw.getMessage("W0112"),3E3),e.callBackFunction.call("",a,d[1],"","","")}else e.submitMsgShow&&naw.showSlideMessage(naw.getMessage("W0112"),3E3),e.callBackFunction.call("",c,"","","","")}})}else{var c=
jQuery("#"+e.renderTo+"_form"),g=e.renderTo+"_table";d="string"==typeof d?d:jQuery.param(d);jQuery.each(d.split("&"),function(){var a=this.split("="),b=c.find("[name="+a[0]+"]");0==b.length?jQuery("<input type='hidden' name='"+a[0]+"' id='"+a[0]+"' value='"+a[1]+"'>").appendTo(c):b.val(a[1])});c.attr("action",a);c.ajaxForm({uploadProgress:function(a,c,b,f){jQuery("#"+e.renderTo+"_progressbar").css("width",f+"%")},success:function(a,c,b,f){jQuery("#"+e.renderTo+"_progressbar").css("width","100%");
naw._hideAccessDeny();c=jQuery.trim(c);if("success"==c){c=[];b=[];f=[];var d=[],q=[],m=jQuery.trim(a).replace(/&amp;/g,"&").split("|");a=m[0].split(">");"0000"==a[1]&&(a[0]="0000");if("0000"==a[0]){var m=naw.convertObject(m[2]),t;for(t in m)c[t]=m[t].fname,b[t]=m[t].fsavename,f[t]=m[t].fext,d[t]=m[t].fsize,q[t]=m[t].fpath;for(var m=jQuery("#"+g)[0],h=0;h<m.rows.length;h++){t=jQuery(m.rows[h].cells[0].childNodes[0]).html();for(var l=0;l<c.length;l++)if(t==c[l]){jQuery(m.rows[h].cells[2]).html("OK / "+
b[l]+" / "+d[l]+"byte");break}}e.submitMsgShow&&naw.showSlideMessage(naw.getMessage("W0111"),3E3);e.callBackFunction.call("",a[0],c,b,f,d,q,e.renderTo);jQuery("#"+e.renderTo+"_maxSize").text("0KB / "+e.maxFileSize/1024+"MB");jQuery("#"+e.renderTo+"_more").find("input").remove();jQuery("#"+e.renderTo+"_add").attr("for",e.renderTo+"_input1");e.upload_number=1}else""!=m[1]?-1==m[1].indexOf("permitted")?e.submitMsgShow&&naw.showSlideMessage("fileupload : "+a[1]+":"+m[1],3E3):e.submitMsgShow&&naw.showSlideMessage(naw.getMessage("W0113"),
3E3):e.submitMsgShow&&naw.showSlideMessage(naw.getMessage("W0112"),3E3),e.callBackFunction.call("",a[1],m[1],"","","")}else e.submitMsgShow&&naw.showSlideMessage(naw.getMessage("W0112"),3E3),e.callBackFunction.call("",c,"","","","")}});c.submit()}}},_deleteFile:function(a){},_fileuploadStream:function(a,d,b,e,l){var h;h="funCd=save";null!=d&&(h+="&subFPath="+d);null!=b&&(h+="&fPrefix="+b);h+="&drm="+e;if(this.userObj){for(var p in this.userObj)h+="&"+p+"="+this.userObj[p];this.userObj=void 0}l&&(h+=
"&saveFName="+l);d=naw._getServletUri?naw._getServletUri("upload"):naw._getFixedUri(naw.config.servletURI.upload);null!=a?naw.config.crossDomain&&naw.config.crossDomain.apply?this._upload(d+"?upload_id="+a+"&iscross=Y",h,"POST"):this._upload(d+"?upload_id="+a,h,"POST"):this._upload(d,h,"POST")}});(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):a("undefined"!=typeof jQuery?jQuery:window.Zepto)})(function(a){function d(c){var b=c.data;c.isDefaultPrevented()||(c.preventDefault(),
a(c.target).ajaxSubmit(b))}function b(c){var b=c.target,d=a(b);if(!d.is("[type=submit],[type=image]")){b=d.closest("[type=submit]");if(0===b.length)return;b=b[0]}var e=this;e.clk=b;"image"==b.type&&(void 0!==c.offsetX?(e.clk_x=c.offsetX,e.clk_y=c.offsetY):"function"==typeof a.fn.offset?(d=d.offset(),e.clk_x=c.pageX-d.left,e.clk_y=c.pageY-d.top):(e.clk_x=c.pageX-b.offsetLeft,e.clk_y=c.pageY-b.offsetTop));setTimeout(function(){e.clk=e.clk_x=e.clk_y=null},100)}function e(){if(a.fn.ajaxSubmit.debug){var c=
"[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(c):window.opera&&window.opera.postError&&window.opera.postError(c)}}var l,h;l=void 0!==a("<input type='file'/>").get(0).files;h=void 0!==window.FormData;var p=!!a.fn.prop;a.fn.attr2=function(){if(!p)return this.attr.apply(this,arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"===typeof a?a:this.attr.apply(this,arguments)};a.fn.ajaxSubmit=function(c){function b(b){b=
a.param(b,c.traditional).split("&");var d=b.length,e=[],f,m;for(f=0;f<d;f++)b[f]=b[f].replace(/\+/g," "),m=b[f].split("="),e.push([decodeURIComponent(m[0]),decodeURIComponent(m[1])]);return e}function d(d){for(var f=new FormData,e=0;e<d.length;e++)f.append(d[e].name,d[e].value);if(c.extraData)for(d=b(c.extraData),e=0;e<d.length;e++)d[e]&&f.append(d[e][0],d[e][1]);c.data=null;e=a.extend(!0,{},a.ajaxSettings,c,{contentType:!1,processData:!1,cache:!1,type:t||"POST"});c.uploadProgress&&(e.xhr=function(){var b=
a.ajaxSettings.xhr();b.upload&&b.upload.addEventListener("progress",function(a){var b=0,d=a.loaded||a.position,e=a.total;a.lengthComputable&&(b=Math.ceil(d/e*100));c.uploadProgress(a,d,e,b)},!1);return b});e.data=null;var m=e.beforeSend;e.beforeSend=function(a,b){b.data=c.formData?c.formData:f;m&&m.call(this,a,b)};return a.ajax(e)}function q(b){function d(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(F){e("cannot get iframe.contentWindow document: "+F)}if(b)return b;try{b=
a.contentDocument?a.contentDocument:a.document}catch(F){e("cannot get iframe.contentDocument: "+F),b=a.document}return b}function f(){function b(){try{var a=d(r).readyState;e("state = "+a);a&&"uninitialized"==a.toLowerCase()&&setTimeout(b,50)}catch(I){e("Server abort: ",I," (",I.name,")"),m(2),E&&clearTimeout(E),E=void 0}}var c=v.attr2("target"),f=v.attr2("action"),q=v.attr("enctype")||v.attr("encoding")||"multipart/form-data";g.setAttribute("target",h);t&&!/post/i.test(t)||g.setAttribute("method",
"POST");f!=k.url&&g.setAttribute("action",k.url);k.skipEncodingOverride||t&&!/post/i.test(t)||v.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});k.timeout&&(E=setTimeout(function(){x=!0;m(1)},k.timeout));var n=[];try{if(k.extraData)for(var l in k.extraData)k.extraData.hasOwnProperty(l)&&(a.isPlainObject(k.extraData[l])&&k.extraData[l].hasOwnProperty("name")&&k.extraData[l].hasOwnProperty("value")?n.push(a('<input type="hidden" name="'+k.extraData[l].name+'">').val(k.extraData[l].value).appendTo(g)[0]):
n.push(a('<input type="hidden" name="'+l+'">').val(k.extraData[l]).appendTo(g)[0]));k.iframeTarget||u.appendTo("body");r.attachEvent?r.attachEvent("onload",m):r.addEventListener("load",m,!1);setTimeout(b,15);try{g.submit()}catch(K){document.createElement("form").submit.apply(g)}}finally{g.setAttribute("action",f),g.setAttribute("enctype",q),c?g.setAttribute("target",c):v.removeAttr("target"),a(n).remove()}}function m(b){if(!n.aborted&&!A)if(w=d(r),w||(e("cannot access response document"),b=2),1===
b&&n)n.abort("timeout"),y.reject(n,"timeout");else if(2==b&&n)n.abort("server abort"),y.reject(n,"error","server abort");else if(w&&w.location.href!=k.iframeSrc||x){r.detachEvent?r.detachEvent("onload",m):r.removeEventListener("load",m,!1);b="success";var c;try{if(x)throw"timeout";var f="xml"==k.dataType||w.XMLDocument||a.isXMLDoc(w);e("isXml="+f);if(!f&&window.opera&&(null===w.body||!w.body.innerHTML)&&--B){e("requeing onLoad callback, DOM not available");setTimeout(m,250);return}var g=w.body?w.body:
w.documentElement;n.responseText=g?g.innerHTML:null;n.responseXML=w.XMLDocument?w.XMLDocument:w;f&&(k.dataType="xml");n.getResponseHeader=function(a){return{"content-type":k.dataType}[a.toLowerCase()]};g&&(n.status=Number(g.getAttribute("status"))||n.status,n.statusText=g.getAttribute("statusText")||n.statusText);var q=(k.dataType||"").toLowerCase(),t=/(json|script|text)/.test(q);if(t||k.textarea){var h=w.getElementsByTagName("textarea")[0];if(h)n.responseText=h.value,n.status=Number(h.getAttribute("status"))||
n.status,n.statusText=h.getAttribute("statusText")||n.statusText;else if(t){var v=w.getElementsByTagName("pre")[0],p=w.getElementsByTagName("body")[0];v?n.responseText=v.textContent?v.textContent:v.innerText:p&&(n.responseText=p.textContent?p.textContent:p.innerText)}}else"xml"==q&&!n.responseXML&&n.responseText&&(n.responseXML=C(n.responseText));try{z=J(n,q,k)}catch(G){b="parsererror",n.error=c=G||b}}catch(G){e("error caught: ",G),b="error",n.error=c=G||b}n.aborted&&(e("upload aborted"),b=null);
n.status&&(b=200<=n.status&&300>n.status||304===n.status?"success":"error");"success"===b?(k.success&&k.success.call(k.context,z,"success",n),y.resolve(n.responseText,"success",n),l&&a.event.trigger("ajaxSuccess",[n,k])):b&&(void 0===c&&(c=n.statusText),k.error&&k.error.call(k.context,n,b,c),y.reject(n,"error",c),l&&a.event.trigger("ajaxError",[n,k,c]));l&&a.event.trigger("ajaxComplete",[n,k]);l&&!--a.active&&a.event.trigger("ajaxStop");k.complete&&k.complete.call(k.context,n,b);A=!0;k.timeout&&clearTimeout(E);
setTimeout(function(){k.iframeTarget?u.attr("src",k.iframeSrc):u.remove();n.responseXML=null},100)}}var g=v[0],q,k,l,h,u,r,n,x,E,y=a.Deferred();y.abort=function(a){n.abort(a)};if(b)for(q=0;q<D.length;q++)b=a(D[q]),p?b.prop("disabled",!1):b.removeAttr("disabled");k=a.extend(!0,{},a.ajaxSettings,c);k.context=k.context||k;h="jqFormIO"+(new Date).getTime();k.iframeTarget?(u=a(k.iframeTarget),(q=u.attr2("name"))?h=q:u.attr2("name",h)):(u=a('<iframe name="'+h+'" src="'+k.iframeSrc+'" />'),u.css({position:"absolute",
top:"-1000px",left:"-1000px"}));r=u[0];n={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(b){var c="timeout"===b?"timeout":"aborted";e("aborting upload... "+c);this.aborted=1;try{r.contentWindow.document.execCommand&&r.contentWindow.document.execCommand("Stop")}catch(F){}u.attr("src",k.iframeSrc);n.error=c;k.error&&k.error.call(k.context,n,c,b);l&&a.event.trigger("ajaxError",
[n,k,c]);k.complete&&k.complete.call(k.context,n,c)}};(l=k.global)&&0===a.active++&&a.event.trigger("ajaxStart");l&&a.event.trigger("ajaxSend",[n,k]);if(k.beforeSend&&!1===k.beforeSend.call(k.context,n,k))return k.global&&a.active--,y.reject(),y;if(n.aborted)return y.reject(),y;(b=g.clk)&&(q=b.name)&&!b.disabled&&(k.extraData=k.extraData||{},k.extraData[q]=b.value,"image"==b.type&&(k.extraData[q+".x"]=g.clk_x,k.extraData[q+".y"]=g.clk_y));b=a("meta[name=csrf-token]").attr("content");(q=a("meta[name=csrf-param]").attr("content"))&&
b&&(k.extraData=k.extraData||{},k.extraData[q]=b);k.forceSync?f():setTimeout(f,10);var z,w,B=50,A,C=a.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},H=a.parseJSON||function(a){return window.eval("("+a+")")},J=function(b,c,d){var e=b.getResponseHeader("content-type")||"",f="xml"===c||!c&&0<=e.indexOf("xml");
b=f?b.responseXML:b.responseText;f&&"parsererror"===b.documentElement.nodeName&&a.error&&a.error("parsererror");d&&d.dataFilter&&(b=d.dataFilter(b,c));"string"===typeof b&&("json"===c||!c&&0<=e.indexOf("json")?b=H(b):("script"===c||!c&&0<=e.indexOf("javascript"))&&a.globalEval(b));return b};return y}if(!this.length)return e("ajaxSubmit: skipping submit process - no element selected"),this;var t,f,v=this;"function"==typeof c?c={success:c}:void 0===c&&(c={});t=c.type||this.attr2("method");f=c.url||
this.attr2("action");(f=(f="string"===typeof f?a.trim(f):"")||window.location.href||"")&&(f=(f.match(/^([^#]+)/)||[])[1]);c=a.extend(!0,{url:f,success:a.ajaxSettings.success,type:t||a.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},c);f={};this.trigger("form-pre-serialize",[this,c,f]);if(f.veto)return e("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(c.beforeSerialize&&!1===c.beforeSerialize(this,c))return e("ajaxSubmit: submit aborted via beforeSerialize callback"),
this;var u=c.traditional;void 0===u&&(u=a.ajaxSettings.traditional);var D=[],r,x=this.formToArray(c.semantic,D);c.data&&(c.extraData=c.data,r=a.param(c.data,u));if(c.beforeSubmit&&!1===c.beforeSubmit(x,this,c))return e("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[x,this,c,f]);if(f.veto)return e("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;f=a.param(x,u);r&&(f=f?f+"&"+r:r);"GET"==c.type.toUpperCase()?(c.url+=(0<=c.url.indexOf("?")?
"&":"?")+f,c.data=null):c.data=f;var z=[];c.resetForm&&z.push(function(){v.resetForm()});c.clearForm&&z.push(function(){v.clearForm(c.includeHidden)});if(!c.dataType&&c.target){var B=c.success||function(){};z.push(function(b){var d=c.replaceTarget?"replaceWith":"html";a(c.target)[d](b).each(B,arguments)})}else c.success&&z.push(c.success);c.success=function(a,b,d){for(var e=c.context||this,f=0,g=z.length;f<g;f++)z[f].apply(e,[a,b,d||v,v])};if(c.error){var C=c.error;c.error=function(a,b,d){C.apply(c.context||
this,[a,b,d,v])}}if(c.complete){var H=c.complete;c.complete=function(a,b){H.apply(c.context||this,[a,b,v])}}r=0<a("input[type=file]:enabled",this).filter(function(){return""!==a(this).val()}).length;f="multipart/form-data"==v.attr("enctype")||"multipart/form-data"==v.attr("encoding");u=l&&h;e("fileAPI :"+u);var A;!1!==c.iframe&&(c.iframe||(r||f)&&!u)?c.closeKeepAlive?a.get(c.closeKeepAlive,function(){A=q(x)}):A=q(x):A=(r||f)&&u?d(x):a.ajax(c);v.removeData("jqxhr").data("jqxhr",A);for(r=0;r<D.length;r++)D[r]=
null;this.trigger("form-submit-notify",[this,c]);return this};a.fn.ajaxForm=function(c){c=c||{};c.delegation=c.delegation&&a.isFunction(a.fn.on);if(!c.delegation&&0===this.length){var g=this.selector,m=this.context;if(!a.isReady&&g)return e("DOM not ready, queuing ajaxForm"),a(function(){a(g,m).ajaxForm(c)}),this;e("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)"));return this}return c.delegation?(a(document).off("submit.form-plugin",this.selector,d).off("click.form-plugin",
this.selector,b).on("submit.form-plugin",this.selector,c,d).on("click.form-plugin",this.selector,c,b),this):this.ajaxFormUnbind().bind("submit.form-plugin",c,d).bind("click.form-plugin",c,b)};a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};a.fn.formToArray=function(b,d){var c=[];if(0===this.length)return c;var e=this[0],g=this.attr("id"),f=b?e.getElementsByTagName("*"):e.elements;f&&!/MSIE [678]/.test(navigator.userAgent)&&(f=a(f).get());g&&(g=a(':input[form="'+
g+'"]').get(),g.length&&(f=(f||[]).concat(g)));if(!f||!f.length)return c;var h,u,p,r,x;h=0;for(x=f.length;h<x;h++)if(r=f[h],(g=r.name)&&!r.disabled)if(b&&e.clk&&"image"==r.type)e.clk==r&&(c.push({name:g,value:a(r).val(),type:r.type}),c.push({name:g+".x",value:e.clk_x},{name:g+".y",value:e.clk_y}));else if((p=a.fieldValue(r,!0))&&p.constructor==Array)for(d&&d.push(r),u=0,r=p.length;u<r;u++)c.push({name:g,value:p[u]});else if(l&&"file"==r.type)if(d&&d.push(r),p=r.files,p.length)for(u=0;u<p.length;u++)c.push({name:g,
value:p[u],type:r.type});else c.push({name:g,value:"",type:r.type});else null!==p&&"undefined"!=typeof p&&(d&&d.push(r),c.push({name:g,value:p,type:r.type,required:r.required}));!b&&e.clk&&(f=a(e.clk),h=f[0],(g=h.name)&&!h.disabled&&"image"==h.type&&(c.push({name:g,value:f.val()}),c.push({name:g+".x",value:e.clk_x},{name:g+".y",value:e.clk_y})));return c};a.fn.formSerialize=function(b){return a.param(this.formToArray(b))};a.fn.fieldSerialize=function(b){var c=[];this.each(function(){var d=this.name;
if(d){var e=a.fieldValue(this,b);if(e&&e.constructor==Array)for(var g=0,f=e.length;g<f;g++)c.push({name:d,value:e[g]});else null!==e&&"undefined"!=typeof e&&c.push({name:this.name,value:e})}});return a.param(c)};a.fn.fieldValue=function(b){for(var c=[],e=0,d=this.length;e<d;e++){var h=a.fieldValue(this[e],b);null===h||"undefined"==typeof h||h.constructor==Array&&!h.length||(h.constructor==Array?a.merge(c,h):c.push(h))}return c};a.fieldValue=function(b,e){var c=b.name,d=b.type,g=b.tagName.toLowerCase();
void 0===e&&(e=!0);if(e&&(!c||b.disabled||"reset"==d||"button"==d||("checkbox"==d||"radio"==d)&&!b.checked||("submit"==d||"image"==d)&&b.form&&b.form.clk!=b||"select"==g&&-1==b.selectedIndex))return null;if("select"==g){var f=b.selectedIndex;if(0>f)return null;for(var c=[],g=b.options,h=(d="select-one"==d)?f+1:g.length,f=d?f:0;f<h;f++){var l=g[f];if(l.selected){var p=l.value;p||(p=l.attributes&&l.attributes.value&&!l.attributes.value.specified?l.text:l.value);if(d)return p;c.push(p)}}return c}return a(b).val()};
a.fn.clearForm=function(b){return this.each(function(){a("input,select,textarea",this).clearFields(b)})};a.fn.clearFields=a.fn.clearInputs=function(b){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)jQuery/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();c.test(d)||"textarea"==e?this.value="":"checkbox"==d||"radio"==d?this.checked=!1:"select"==e?this.selectedIndex=-1:"file"==d?/MSIE/.test(navigator.userAgent)?a(this).replaceWith(a(this).clone(!0)):
a(this).val(""):b&&(!0===b&&/hidden/.test(d)||"string"==typeof b&&a(this).is(b))&&(this.value="")})};a.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};a.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};a.fn.selected=function(b){void 0===b&&(b=!0);return this.each(function(){var c=this.type;"checkbox"==c||"radio"==c?this.checked=b:"option"==this.tagName.toLowerCase()&&
(c=a(this).parent("select"),b&&c[0]&&"select-one"==c[0].type&&c.find("option").selected(!1),this.selected=b)})};a.fn.ajaxSubmit.debug=!1});B._addWidget("fileupload",naw.widget.fileupload)})(naw);