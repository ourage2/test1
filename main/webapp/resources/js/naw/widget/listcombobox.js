(function($){$.namespace("widget.listcombobox");var DOMEVENT={};DOMEVENT.key={KEY_BACKSPACE:8,KEY_TAB:9,KEY_ENTER:13,KEY_ESCAPE:27,KEY_SPACE:32,KEY_SHIFT:16,KEY_CTRL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_CAPS_LOCK:20,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT_ARROW:37,KEY_UP_ARROW:38,KEY_RIGHT_ARROW:39,KEY_DOWN_ARROW:40,KEY_INSERT:45,KEY_DELETE:46,KEY_HELP:47,KEY_LEFT_WINDOW:91,KEY_RIGHT_WINDOW:92,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,
KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_NUM_LOCK:144,KEY_SCROLL_LOCK:145};var g_isIE=false;var g_seletArray=[];var g_browser=$.agent.browser;var rCho=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"];var rJung=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"];var rJong=["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"];if(!MSG_comboBox)var MSG_comboBox={};MSG_comboBox.create=
$.getMessage("W0301");MSG_comboBox.create_1=$.getMessage("W0302");MSG_comboBox.optionType=$.getMessage("W0303");MSG_comboBox.initialize=$.getMessage("W0304");MSG_comboBox.isParam_1=$.getMessage("W0305");$.widget.listcombobox=$.widget.Base.extend({init:function(){this.setName("listcombobox");this._super(arguments[0],arguments[1]);var conf=this._getTemplate(arguments[0]);conf.renderTo=arguments[1].id;this.id=arguments[1].id;this.comboEle=arguments[1];this.$comboEle=jQuery(arguments[1]);this.DumpData=
[];this.restoreData=[];this.filterTmpCellData=[];this.ref=[];this.beforeLen=0;this.tootipTarget=null;this.widgets=conf.widgets?conf.widgets:null;this.rect=conf.rect?conf.rect:Object();this.valueLimit=conf.valueLimit?conf.valueLimit:false;this.maxlength=null;if(conf.maxLength!=undefined)this.maxlength=conf.maxLength;if(conf.maxlength!=undefined)this.maxlength=conf.maxlength;this.defaultValue=conf.defaultValue!=undefined?conf.defaultValue:null;this.disabled=conf.disabled?conf.disabled:false;this.width=
conf.width?parseFloat(conf.width):null;this.widthunit=conf.width&&typeof conf.width=="string"&&conf.width.indexOf("%")>-1?"%":"px";this.listPnlHeight=conf.listPnlHeight!=undefined?parseFloat(conf.listPnlHeight):undefined;this.renderTo=conf.renderTo?conf.renderTo:null;this.items=conf.items?conf.items:null;this.filter=conf.filter?conf.filter:null;this.sColumn=conf.sColumn?conf.sColumn:[];this.sColumnWidth=conf.sColumnWidth?conf.sColumnWidth:[];this.sColumnAlign=conf.sColumnAlign?conf.sColumnAlign:[];
this.inputEditable=conf.inputEditable===false?false:true;this.transform=conf.transform=="uppercase"||conf.transform=="lowercase"?conf.transform:undefined;this.multiSelect=conf.multiSelect===true?true:false;if(this.sColumn.length==0)this.multiSelect=false;this.title=jQuery.isArray(conf.title)?conf.title:[];this.inputClickListOpen=true;if(naw.config.listcombobox&&naw.config.listcombobox.inputClickListOpen===false)this.inputClickListOpen=false;this.buttonClickListOpen=false;if(naw.config.listcombobox&&
naw.config.listcombobox.buttonClickListOpen===true)this.buttonClickListOpen=true;this.listTooltip=conf.listTooltip?conf.listTooltip:false;this.onChange=conf.onChange?conf.onChange:null;this.onInputChange=conf.onInputChange?conf.onInputChange:null;this.onMouseOver=conf.onMouseOver?conf.onMouseOver:null;this.onMouseOut=conf.onMouseOut?conf.onMouseOut:null;this.onKeyUp=conf.onKeyUp?conf.onKeyUp:null;this.onKeyDown=conf.onKeyDown?conf.onKeyDown:null;this.onBlur=conf.onBlur?conf.onBlur:null;this.onListFolded=
conf.onListFolded?conf.onListFolded:null;if($.isNull(conf)){alert("listcombobox 구성 요소를 확인 하시기 바랍니다.");return false}if(!conf.listcomboStruct||!conf.listcomboStruct.key){alert("listcombobox 구성 요소를 확인 하시기 바랍니다.");return false}if(typeof conf!="object"){var jsonListComboStruct=(new Function("return "+gridTestData))();this.makeParam(jsonListComboStruct);this.create(arguments[1].id)}else{this.makeParam(conf);this.create(arguments[1].id)}},_eventBind:function(){var self=this;var events=["change","inputChange",
"mouseOver","mouseOut","keyUp","keyDown","blur","listFolded","titleChange"];for(var i=0,eventLen=events.length;i<eventLen;i++){var name=events[i];self[name]=function(that,nm){return function(fn){that["on"+nm.substring(0,1).toUpperCase()+nm.substr(1)]=fn}}(self,name)}},_isWidgets:function(){if(!this.widgets){$.showSlideMessage(MSG_comboBox.initialize+"(isWidgets : "+this.widgets+")",5E3);return false}return true},makeParam:function(conf){if(!$.isNull(conf.ref))this.ref=conf.ref;if(!$.isNull(conf.listcomboStruct))this.listcomboStruct=
conf.listcomboStruct},create:function(argID){this.listComboEvt(this);var that=this;var oSelect=this.renderTo;if(typeof oSelect=="string")oSelect=document.getElementById(oSelect);else{$.showSlideMessage(MSG_comboBox.create+"(Create0)",5E3);return null}if(oSelect==null){$.showSlideMessage(MSG_comboBox.create+"(Create1)",5E3);return null}if(oSelect.tagName!="SPAN"){$.showSlideMessage(MSG_comboBox.create+"(Create2)",5E3);return null}if(g_browser=="msie")g_isIE=true;jQuery(oSelect).off().removeAttr("style");
jQuery(oSelect).find("> span").remove();jQuery("body").find("> span#"+this.renderTo+"-combo-list").remove();$.subscribe("theme.change",function(data){that.changeTheme(data.themeName,data.themeBasePath)});$.subscribe("widget.reset",function(data){if(data.target=="*"||data.target.id()==that.renderTo)that.widgets._selectOption_core(that.defaultValue)});var _DOMParent=oSelect;this.rect.widthunit=this.widthunit;this.rect.width=this.width==null?jQuery("#"+this.renderTo).width():this.width;this.rect.height=
"22";this.widgets=new this.coreCombo(this);this.widgets.maxlength=this.maxlength!=null?this.maxlength:null;this.widgets.defaultValue=this.defaultValue;this.widgets.disabled=this.disabled;this.widgets.valueLimit=this.valueLimit;this.widgets.onChange=this.onChange;this.widgets.onInputChange=this.onInputChange;this.widgets.onMouseOver=this.onMouseOver;this.widgets.onMouseOut=this.onMouseOut;this.widgets.onKeyUp=this.onKeyUp;this.widgets.onKeyDown=this.onKeyDown;this.widgets.onBlur=this.onBlur;this.widgets._init(_DOMParent,
oSelect,this.rect);this._eventBind();return this.widgets},listComboEvt:function(that){if(this.ref)for(var len=0;len<this.ref.length;len++){var refSplit=this.ref[len].split("@");this.setRef(this.ref[len]);$.subscribe("binder."+refSplit[0]+"."+refSplit[1],function(data){that.addDumpData(data,"first")})}},addDumpData:function(data){if(this.DumpData.length!=0){delete this.DumpData;this.DumpData=[]}var rowData=arguments[0];if(typeof rowData=="object"){var beforeLen=this.restoreData.length;var rowDataLen=
rowData.length;var i=0;while(i<rowDataLen){if(naw.isNull(rowData[i][this.listcomboStruct.key])){rowData.splice(i,1);rowDataLen--;continue}this.DumpData[i]=new Object;this.DumpData[i].dt=rowData[i];this.DumpData[i].idx=beforeLen+i;if(arguments[1]=="first")this.restoreData[beforeLen+i]=jQuery.extend(true,{},this.DumpData[i]);i++}delete rowData}this.addJSONData()},removeAll:function(){if(!this._isWidgets())return null;this.widgets.optionsArr=new Array;this.widgets._redrawOptions();if(arguments[0]&&arguments[0]==
"bclick");else this.widgets._selOption=null;if(!arguments[0])this.widgets._setText("")},addJSONData:function(){var self=this;if(arguments.length==1&&arguments[0]=="filter")self.removeAll("filter");else if(arguments.length==1&&arguments[0]=="bclick")self.removeAll("bclick");else self.removeAll();var oThis=self.widgets;var x=new Array;var len=self.DumpData.length;var listPnl=self.widgets.DOMlistPnl,$listPnl=jQuery(listPnl);if(arguments.length==1&&arguments[0]=="filter")if(len==0)$listPnl.hide();else if(self.inputClickListOpen===
true)$listPnl.show();else{listPnl.style.display="block";if(self.sColumn.length>0)if(oThis.DOMlist.firstChild!=null)oThis.DOMlistPnl.style.width=oThis.DOMlist.firstChild.style.width;oThis._positList(oThis)}else;var i=0;while(i<len){x[i]=[this.DumpData[i].dt,this.DumpData[i].idx];i++}if(x.length>0)this.widgets._addOption_core(x)},_getIndexByValue:function(value){if(!this._isWidgets())return null;for(var i=0;i<this.widgets.optionsArr.length;i++)if(this.widgets.optionsArr[i].value==value)return i;return null},
_getText:function(){if(!this._isWidgets())return null;return this.widgets.DOMelem_input.value},_getOptionText:function(idx){if(!this._isWidgets())return null;if(!this._isParamCheck({index:idx}))return null;return this.widgets.optionsArr[idx].text},_getSelectedValue:function(){if(!this._isWidgets())return null;return this.widgets._selOption?this.widgets._selOption.value:null},_isParamCheck:function(param){var isParam=true;var idx=param.index;if(typeof idx!="undefined"){var tempVal=String(idx);if(isNaN(idx)||
idx==null||tempVal==""||tempVal.length<=0){isParam=false;$.showSlideMessage(MSG_comboBox.isParam_1+"(isParamCheck , idx:"+idx+")",5E3)}if(idx<0||this.widgets.optionsArr.length<=idx){isParam=false;$.showSlideMessage(MSG_comboBox.isParam_1+"(isParamCheck , idx:"+idx+")",5E3)}}return isParam},_setSelectedValue:function(value){for(var i=0;i<this.widgets.optionsArr.length;i++)if(this.widgets.optionsArr[i].value==value){this.widgets._selectOption_core(i);return true}this.widgets._unSelectOption();this.widgets._setText("");
return false},_closeListPnl_:function(that,e){var self=that,oThis=self.widgets;var prevOpenFlag=false;if(jQuery(oThis.DOMlistPnl).is(":visible")==true)prevOpenFlag=true;oThis.DOMlistPnl.style.display="none";if(that.multiSelect&&typeof that.onListFolded=="function"&&prevOpenFlag==true)that.onListFolded.call(that,e,{})},coreCombo:function(that){var comboObject=this;this.selectId=null;this.selectWidth=null;this.selectHeight=null;this.selectWidthUnit=null;this.DOMParent=null;this.DOMelem=null;this.DOMelem_input=
null;this.DOMelem_button=null;this.DOMListPnl=null;this.DOMListTitle=null;this.DOMlist=null;this.DOMlistF=null;this._selOption=null;this.optionsArr=null;this._blueOption=null;this._skiprender=null;this._init=function(_DOMParent,oSelect,rect){this.DOMParent=_DOMParent;this.selectId=jQuery("#"+oSelect.id);this.selectWidth=rect.width;this.selectHeight=rect.height;this.selectWidthUnit=rect.widthunit;var oThis=this;jQuery(document).off("mouseup.d"+that.id);jQuery(document).on("mouseup.d"+that.id,function(e){var listPnlMouseUp=
false,listcomboboxPnlMouseUp=false;if(naw(oThis.DOMlist.parentNode).contains(e.target)==true)listPnlMouseUp=true;if(naw(that.comboEle,true).contains(e.target)==true)listcomboboxPnlMouseUp=true;if(!listPnlMouseUp&&!listcomboboxPnlMouseUp)that._closeListPnl_(that,e)});jQuery(document.body).off("keydown.d"+that.id);jQuery(document.body).on("keydown.d"+that.id,function(e){try{if((e||window.event).keyCode==9)that._closeListPnl_(that,e)}catch(e$0){}return true});this._createHTML(oSelect);g_seletArray.push(this)};
this._Remove=function(){comboObject=null;this.selectId=null;this.selectWidth=null;this.selectHeight=null;this._destructor();this.DOMlist.combo=null;this.DOMelem.combo=null;this.DOMParent=null;this.DOMelem=null;this.DOMelem_input=null;this.DOMelem_button=null;this.DOMListPnl=null;this.DOMListTitle=null;this.DOMlist=null;this.DOMlistF=null;this._selOption=null;this._escOption=null;this.optionsArr=null;this._skiprender=null};this._destructor=function(){this.optionsArr=[];g_seletArray=[]};this._addOption_core=
function(options){var args;var attr;if(!arguments[0].length)args=[arguments];else args=options;this._render(false);for(var i=0;i<args.length;i++){attr=args[i];this._addOption(attr)}this._render(true)};this._addOption=function(attr){var dOpt=new this.coreOption;this.optionsArr.push(dOpt);dOpt._setValue.apply(dOpt,[attr]);dOpt=null};this._createHTML=function(oSelect){this._selOption=null;this.optionsArr=Array();this._drawTextArea(oSelect);this.DOMlistPnl=document.createElement("span");this.DOMlistPnl.className=
"naw-combo-list-pnl";this.DOMlistPnl.id=this.DOMParent.id+"-combo-list-pnl";this.DOMlistTitle=document.createElement("span");this.DOMlistTitle.className="naw-combo-list-title state-hide";this.DOMlistTitle.id=this.DOMParent.id+"-combo-list-title";var titleInner="<ul></ul>";this.DOMlistTitle.innerHTML=titleInner;this.DOMlist=document.createElement("span");this.DOMlist.className="naw-combo-list";this.DOMlist.id=this.DOMParent.id+"-combo-list";if(that.sColumn.length>0)this.DOMlist.className="naw-combo-list combo-grid-view";
else if(this.selectWidth>=2)this.DOMlistPnl.style.width=(this.selectWidthUnit=="%"?jQuery(oSelect).width():that.width-2)+"px";this.DOMlistPnl.style.display="none";this.DOMlistPnl.appendChild(this.DOMlistTitle);this.DOMlistPnl.appendChild(this.DOMlist);document.body.appendChild(this.DOMlistPnl);jQuery(this.DOMlistPnl).hide();this.DOMlist.combo=this.DOMelem.combo=this;this.DOMelem_input.onkeydown=this._onKeyDown;this.DOMelem_input.onkeyup=this._onKeyUp;this.DOMelem_input.onkeypress=this._onKeyPress;
this.DOMlist.onmouseover=this._mouseSelectOption;this.DOMlist.onmouseout=this._mouseoutSelectOption;if(that.inputClickListOpen===false);else this.DOMelem_input.onclick=this._openSelect;if(that.buttonClickListOpen===true)this.DOMelem_button.onclick=this._openSelect;else this.DOMelem_button.onclick=this._restoreData;that.comboList=this.DOMlist;that.DOMlistPnl=this.DOMlistPnl;that.DOMlistTitle=this.DOMlistTitle;if(that.listPnlHeight!=undefined)jQuery(this.DOMlist).css("max-height",that.listPnlHeight);
this._eventDefine()};this._closeAll=function(){if(g_seletArray)for(var i=0;i<g_seletArray.length;i++)jQuery(g_seletArray[i].DOMlistPnl).hide()};this._drawTextArea=function(oSelect){var s_box=document.createElement("span");if(this.selectWidth>=4)s_box.style.width=this.selectWidth-0+this.selectWidthUnit;this.DOMelem=s_box;this._drawTextBox();this._drawTextButton();this.DOMParent.appendChild(this.DOMelem)};this._drawTextBox=function(){var inputText=document.createElement("input");inputText.type="text";
if(that.inputEditable===false)inputText.readOnly="readOnly";var hasNX=false,dataNXObj={type:"text"};if(!$.isNull(that.listcomboStruct.type)){dataNXObj["type"]=that.listcomboStruct.type;if(!$.isNull(that.listcomboStruct.mask))dataNXObj["mask"]=that.listcomboStruct.mask}if(this.maxlength!=null||that.transform!=undefined){if(this.maxlength!=null){dataNXObj["maxlength"]=this.maxlength;dataNXObj["autoSkip"]=false}if(that.transform!=undefined)dataNXObj["transform"]=that.transform}naw(inputText).setNX(dataNXObj);
jQuery(inputText).css("text-align","left");if(this.selectWidth>=19||this.selectWidthUnit=="%")inputText.style.width=this.selectWidth-6+this.selectWidthUnit;this.DOMelem.appendChild(inputText);this.DOMelem_input=inputText;that.comboInput=this.DOMelem_input;if(that.multiSelect)jQuery(that.comboInput).data({"idx":[]})};this._drawTextButton=function(){var imgButton=document.createElement("button");imgButton.setAttribute("type","button");imgButton.className="naw-combo-icon";this.DOMelem.appendChild(imgButton);
this.DOMelem_button=imgButton;this.DOMelem_button.setAttribute("tabindex","-1")};this._eventDefine=function(){var coreComboThis=this;var self=that;jQuery(this.DOMlist).on("mousedown","> div",function(e){that.listDivMouseDown=true}).on("click","> div",function(e){var $this=jQuery(this),$target=jQuery(e.target);var clickIndex=$this.index(),prevIndex=that.selectedIndex(),index=-1,changeFlag=false;if(that.multiSelect){if(e.target.tagName=="INPUT")changeFlag=true}else{index=clickIndex;if(prevIndex!=index)changeFlag=
true}if(changeFlag==true){if(typeof that.onChange=="function"){var prevData=that.getData();coreComboThis._selectOption(e);var data=that.getData();var index=that.selectedIndex();var changeObj={prevIndex:-1,prevValue:"",prevText:"",prevData:{},index:-1,value:"",text:"",data:{},changeIndex:clickIndex};var valueName="",textName=that.listcomboStruct.key;if(that.listcomboStruct.value==undefined)valueName=that.listcomboStruct.key;else valueName=that.listcomboStruct.value;if(that.multiSelect){changeObj.prevIndex=
prevIndex;changeObj.prevData=[];changeObj.prevValue=[];changeObj.prevText=[];for(var i=0,prevIndexLen=prevIndex.length;i<prevIndexLen;i++){changeObj.prevData.push(prevData[i]);changeObj.prevValue.push(prevData[i][valueName]);changeObj.prevText.push(prevData[i][textName])}changeObj.index=index;changeObj.data=[];changeObj.value=[];changeObj.text=[];for(var i=0,indexLen=index.length;i<indexLen;i++){changeObj.data.push(data[i]);changeObj.value.push(data[i][valueName]);changeObj.text.push(data[i][textName])}}else{changeObj.prevIndex=
prevIndex;if(prevData!=null){changeObj.prevData=prevData;changeObj.prevValue=prevData[valueName];changeObj.prevText=prevData[textName]}changeObj.index=index;changeObj.data=data;changeObj.value=data[valueName];changeObj.text=data[textName]}that.onChange.call(this,e,changeObj)}else coreComboThis._selectOption(e);if(that.multiSelect){var allCheckFlag=true;for(var i=0,len=that.DumpData.length;i<len;i++){var DumpData=self.DumpData[i];if(DumpData["ck"]!==true){allCheckFlag=false;break}}jQuery("input",self.DOMlistTitle).prop("checked",
allCheckFlag)}}else if(that.multiSelect==false)that.widgets._closeAll()}).on("mouseover","> div",function(e){if(that.listTooltip===true){var target=e.target,$target=jQuery(target);if(that.sColumn.length>0)if(target.tagName=="P")target.parentNode.title=target.innerHTML;else{if(target.tagName=="LI")target.title=target.firstChild.innerHTML}else this.title=this.innerHTML}});jQuery(this.DOMelem_input).on("change",function(e){if(typeof that.onInputChange=="function")that.onInputChange.call(this,e)});jQuery(this.DOMelem_input).on("mouseover",
function(e){if(typeof that.onMouseOver=="function")that.onMouseOver.call(this,e)});jQuery(this.DOMelem_input).on("mouseout",function(e){if(typeof that.onMouseOut=="function")that.onMouseOut.call(this,e)});jQuery(this.DOMelem_input).on("keyup",function(e){if(that.multiSelect)return true;if(typeof that.onKeyUp=="function")that.onKeyUp.call(this,e)});jQuery(this.DOMelem_input).on("keydown",function(e){if(that.multiSelect)return true;if(typeof that.onKeyDown=="function")that.onKeyDown.call(this,e)});
jQuery(this.DOMelem_input).on("blur",function(e){if(that.listDivMouseDown){that.listDivMouseDown=false;return true}if(that.multiSelect)return true;var changeFlag=false,prevIndex=that.selectedIndex();var valueName="",argData=naw(this).val();valueName=that.listcomboStruct.key;var idx=-1;if(!jQuery.isArray(argData))argData=[argData];for(var i=0,argDataLen=argData.length;i<argDataLen;i++)for(var j=0,len=that.DumpData.length;j<len;j++){var DumpData=that.DumpData[j],tmpData=DumpData.dt[valueName];if(tmpData==
argData[i]){idx=j;break}}if(prevIndex!=idx)changeFlag=true;if(changeFlag===true)if(typeof that.onChange=="function"){var prevData=that.getData();that.selectedIndex(idx);var data=that.getData();var index=that.selectedIndex();var changeObj={prevIndex:-1,prevValue:"",prevText:"",prevData:{},index:-1,value:"",text:"",data:{},changeIndex:idx};var valueName="",textName=that.listcomboStruct.key;if(that.listcomboStruct.value==undefined)valueName=that.listcomboStruct.key;else valueName=that.listcomboStruct.value;
changeObj.prevIndex=prevIndex;if(prevData!=null){changeObj.prevData=prevData;changeObj.prevValue=prevData[valueName];changeObj.prevText=prevData[textName]}changeObj.index=index;changeObj.data=data;if(data!=null){changeObj.value=data[valueName];changeObj.text=data[textName]}that.onChange.call(this,e,changeObj)}else that.selectedIndex(idx);if(typeof that.onBlur=="function")that.onBlur.call(this,e)});jQuery("main").off("scroll.d"+that.id);jQuery("main").on("scroll.d"+that.id,function(e){that._closeListPnl_(that,
e)});jQuery(this.DOMlistTitle).on("change",function(e){if(e.target.type=="checkbox"){var $comboInput=jQuery(that.comboInput);var checked=e.target.checked,text=[],idx=[];for(var i=0,len=that.DumpData.length;i<len;i++){var checkboxEle=jQuery("#"+that.id+"-"+i+"-multiSelect > input");if(checkboxEle.prop("disabled")==true)continue;var DumpData=that.DumpData[i];if(checked===true){DumpData["ck"]=true;that.restoreData[DumpData.idx]["ck"]=true;checkboxEle.prop("checked",true);text.push(DumpData.dt[that.listcomboStruct.key]);
idx.push(i)}else{delete DumpData["ck"];delete that.restoreData[DumpData.idx]["ck"];checkboxEle.prop("checked",false)}}$comboInput.val(text.join(", "));$comboInput.data({"idx":idx});if(typeof that.onTitleChange=="function"){var titleChangeObj={checked:checked};that.onTitleChange.call(this,e,titleChangeObj)}}})};this._eventListener=function(el,eventName,handler){if(el.addEventListener)el.addEventListener(eventName,handler,false);else if(el.attachEvent)el.attachEvent("on"+eventName,handler);else el["on"+
eventName]=handler};this._selectedIndex=function(){if($.isNull(this._selOption))return-1;for(var i=0,optionsArrLength=this.optionsArr.length;i<optionsArrLength;i++)if(this.optionsArr[i].value==this._selOption.value&&this.optionsArr[i].text==this._selOption.text)return i;return-1};this._mouseSelectOption=function(e){(e||window.event).cancelBubble=true;var node=g_isIE?window.event.srcElement:e.target;var oThis=this.combo;if(that.sColumn.length>0){var lengthTooltipEle=null;if(node.className=="highlight"){lengthTooltipEle=
node.parentNode;node=node.parentNode.parentNode.parentNode}if(node.tagName=="LI"){lengthTooltipEle=node;node=node.parentNode.parentNode}if(node.tagName=="P"){lengthTooltipEle=node.parentNode;node=node.parentNode.parentNode.parentNode}if(this._escOption)this._escOption._unselect_op(null);if(!$.isNull(lengthTooltipEle))if(lengthTooltipEle.scrollWidth>jQuery(lengthTooltipEle).width())lengthTooltipEle.title=lengthTooltipEle.innerHTML;for(var i=0,listLen=oThis.DOMlist.childNodes.length;i<listLen;i++)if(oThis.DOMlist.childNodes[i]==
node){oThis._selectOption_core(i,true);if(that.listTooltip);break}}else{if(node.className=="highlight")node=node.parentNode;if(this._escOption)this._escOption._unselect_op(null);for(var i=0,listLen=oThis.DOMlist.childNodes.length;i<listLen;i++)if(oThis.DOMlist.childNodes[i]==node){oThis._selectOption_core(i,true);if(that.listTooltip);break}}};this._mouseoutSelectOption=function(e){(e||window.event).cancelBubble=true;if(that.sColumn.length>0){var node=g_isIE?window.event.srcElement:e.target;var lengthTooltipEle=
null;if(node.className=="highlight")lengthTooltipEle=node.parentNode;if(node.tagName=="LI")lengthTooltipEle=node;if(!$.isNull(lengthTooltipEle))if(lengthTooltipEle.scrollWidth>jQuery(lengthTooltipEle).width())lengthTooltipEle.title=""}else if(that.listTooltip){var oThis=this.combo;if($.agent.browser=="msie"&&$.agent.version==8)for(var i=0,listLen=oThis.DOMlist.childNodes.length;i<listLen;i++)oThis.DOMlist.childNodes[i].title="";else if(e.target&&e.target.tagName=="DIV")e.target.title=""}};this._onChange=
function(e){};this._onKeyUp=function(e){if(that.multiSelect)return true;oThis=this.parentNode.combo;var inText=naw(oThis.DOMelem_input).val();var k=DOMEVENT.key;var ev=(e||window.event).keyCode;if(ev==k.KEY_DOWN_ARROW||ev==k.KEY_UP_ARROW||ev==k.KEY_RIGHT_ARROW||ev==k.KEY_LEFT_ARROW||ev==k.KEY_ENTER||ev==k.KEY_TAB||ev==k.KEY_ESCAPE)return;if($.isNull(that.filter))return false;if(!$.isNull(that.listcomboStruct.type)){if($.isNull(that.listcomboStruct.mask))inText=naw.unValMask(inText,that.listcomboStruct.type);
else inText=naw.unValMask(inText,that.listcomboStruct.mask);if(that.listcomboStruct.type=="num")inText=naw.unValNum(""+inText)}var inTextLen=inText.length;var cText="";if(this._escOption)this._escOption._unselect_op(null);var engNumPattern=/^[a-zA-Z0-9]+$/,korPattern=/([^가-힣\x20])/i;var korChoFlag=false,korChoTmp=0;for(var i=0;i<inTextLen;i++){var cFlag=false;if(korPattern.test(inText[i]))cFlag=true;if(engNumPattern.test(inText[i]))cFlag=false;if(cFlag==true&&inText[i]==" ")cFlag=false;if(cFlag==
true){if(that.filter=="first"&&escape(inText[i].charCodeAt(0)).length>4){korChoFlag=true;korChoTmp=1}break}else cText+=inText[i]}that.DumpData=that.restoreData.slice(0);this._selOption=null;if(cText.length+korChoTmp>that.beforeLen){jQuery(that.DOMlistPnl).children(".naw-combo-list").removeHighlight();var delCnt=0;jQuery(that.DumpData).each(function(index){var keyData=this.dt[that.listcomboStruct.key];if(that.filter=="like"){if(keyData.indexOf(cText)==-1){that.DumpData.splice(index-delCnt,1);delCnt++}}else if(that.filter==
"first")if(keyData.indexOf(cText)!=0){that.DumpData.splice(index-delCnt,1);delCnt++}else if(korChoFlag==true){var inputCho=inText[i],cTextLen=cText.length;var equalAfterText=keyData.substr(cTextLen);if(escape(equalAfterText.charCodeAt(0)).length>4){var cho,jung,jong;var sTest=equalAfterText.charAt(0);var nTmp=sTest.charCodeAt(0)-44032;jong=nTmp%28;jung=(nTmp-jong)/28%21;cho=((nTmp-jong)/28-jung)/21;cho=rCho[cho];if(cho!=inputCho){that.DumpData.splice(index-delCnt,1);delCnt++}}else{that.DumpData.splice(index-
delCnt,1);delCnt++}}})}else{jQuery(that.DOMlistPnl).children(".naw-combo-list").removeHighlight();var delCnt=0;jQuery(that.DumpData).each(function(index){if(that.filter=="like"){if(this.dt[that.listcomboStruct.key].indexOf(cText)==-1){that.DumpData.splice(index-delCnt,1);delCnt++}}else if(that.filter=="first")if(this.dt[that.listcomboStruct.key].indexOf(cText)!=0){that.DumpData.splice(index-delCnt,1);delCnt++}})}that.beforeLen=cText.length;var prevListClose=false;if(jQuery(that.DOMlistPnl).is(":visible")==
false)prevListClose=true;that.addJSONData("filter");if(prevListClose==true)oThis._positList(oThis);jQuery(that.DOMlistPnl).children(".naw-combo-list").highlight(cText,that.filter,that.listcomboStruct)};this._onKeyPress=function(e){if(that.multiSelect)return true;var oThis=this.parentNode.combo;var k=DOMEVENT.key;var ev=e||window.event;if(ev.keyCode==k.KEY_ENTER){oThis._closeAll();return false}if(ev.keyCode==k.KEY_ESCAPE){oThis._restoreOption();oThis._closeAll();return false}return true};this._onKeyDown=
function(e){if(that.multiSelect){e.preventDefault();return true}var oThis=this.parentNode.combo;var k=DOMEVENT.key;var ev=(e||window.event).keyCode;if(ev==k.KEY_DOWN_ARROW)oThis._selectNext(1);else if(ev==k.KEY_UP_ARROW)oThis._selectNext(-1)};this._onKeyDownSelect=function(ev){return;var k=DOMEVENT.key;if(ev==k.KEY_DOWN_ARROW);else if(ev==k.KEY_UP_ARROW);else{ev.cancelBubble=true;for(var i=0;i<this.optionsArr.length;i++)if(this.optionsArr[i]._data()[0]==this.DOMelem_input.value||this.optionsArr[i]._data()[1]==
this.DOMelem_input.value){this._selectOption_core(i);this.DOMelem_input.blur();return false}}return true};this._restoreData=function(e){if(!that.multiSelect)if(that.DumpData.length!=that.restoreData.length){that.DumpData=that.restoreData.slice(0);that.addJSONData("bclick")}else that.widgets._openSelect();else that.widgets._openSelect()};this._openSelect=function(e){var oThis=that.comboEle.firstChild.combo;if(oThis.disabled)return;if(oThis.DOMlist.children.length==0)return;if(oThis.DOMelem_input.disabled==
"disabled"||oThis.DOMelem_input.disabled==true)return;oThis.DOMlistPnl.style.display="block";if(that.sColumn.length>0)oThis.DOMlistPnl.style.width=oThis.DOMlist.firstChild.style.width;oThis._positList(oThis);if(oThis._selOption){oThis._escOption=oThis._selOption;oThis._selectOption_core(oThis._selectedIndex(),true)}oThis.DOMelem_input.select()};this._positList=function(oObj){var pos=oObj.selectId.offset();var x=pos.left;var y=pos.top;var h=oObj.DOMlist.offsetHeight;var w=oObj.DOMlist.offsetWidth;
var dir="down";var $input=jQuery(oObj.DOMelem_input),inputTop=$input.offset().top,inputHeight=$input.outerHeight(true);y=inputTop;var rPos=jQuery(oObj.DOMParent).offset();x=rPos.left;var tmpX=x;var tmpY=y+inputHeight;this.DOMlistPnl.style.position="absolute";var windowHeight=jQuery(window).height(),windowScrollTop=jQuery(window).scrollTop(),listPnlHeight=jQuery(this.DOMlistPnl).outerHeight(true),listPnlTop=tmpY;var calcTmp=windowHeight+windowScrollTop-listPnlTop-listPnlHeight;if(calcTmp<0)tmpY=tmpY-
inputHeight-listPnlHeight;var windowWidth=jQuery(window).width(),windowScrollLeft=jQuery(window).scrollLeft(),listPnlWidth=jQuery(this.DOMlistPnl).outerWidth(true),listPnlLeft=tmpX;var calcTmp=windowWidth+windowScrollLeft-listPnlLeft-listPnlWidth;if(calcTmp<0)tmpX=tmpX+calcTmp;this.DOMlistPnl.style.top=tmpY+"px";this.DOMlistPnl.style.left=tmpX+"px"};this._restoreOption=function(){if(!this._escOption)return;this._unSelectOption();this._selOption=this._escOption;this._setText(this._selOption.text);
this._escOption=null};this._render=function(mode){this._skiprender=!mode;this._redrawOptions()};this._redrawOptions=function(){if(this._skiprender)return;jQuery(this.DOMlist).children().remove();var tempLength=0;var currentLength=0;for(var i=0,optionsArrLen=this.optionsArr.length;i<optionsArrLen;i++){this.DOMlist.appendChild(this.optionsArr[i]._render_op(i));currentLength=$.getByteLength(this.optionsArr[i].text)*7+4;if(tempLength<currentLength)tempLength=currentLength}if(that.sColumn.length==0&&(this.selectWidthUnit==
"%"||this.selectWidthUnit=="px"&&this.selectWidth<tempLength))this.DOMlistPnl.style.width=this.DOMelem_input.offsetWidth+"px";this.DOMlistTitle.firstChild.innerHTML="";if(that.title.length>0){for(var i=0,sColumnLen=that.sColumn.length;i<sColumnLen;i++)if(that.title[i]==undefined)that.title[i]="";var titleStr="";if(sColumnLen>0&&that.multiSelect==true){titleStr+="<li style='width:30px;' ";titleStr+=" >";titleStr+="<input type='checkbox' ";if(false)titleStr+="disabled='disabled' ";titleStr+=" />";titleStr+=
"</li>"}for(var i=0,titleLen=that.title.length;i<titleLen;i++){if(sColumnLen==0&&i==1)break;var sColumnOneWidth=80;if(that.sColumnWidth[i]!=undefined)sColumnOneWidth=parseInt(that.sColumnWidth[i]);titleStr+="<li style='";if(sColumnLen)titleStr+="width:"+sColumnOneWidth+"px; ";titleStr+="'>";titleStr+=that.title[i];titleStr+="</li>"}jQuery(this.DOMlistTitle.firstChild).append(titleStr);jQuery(this.DOMlistTitle).removeClass("state-hide")}else jQuery(this.DOMlistTitle).addClass("state-hide")};this._selectNext=
function(step){var prevIndex=this._selectedIndex();var selIndex=prevIndex+step;if(selIndex<0)return;if(this.optionsArr[selIndex])if(typeof that.onChange=="function"){var prevData=that.getData();this._selectOption_core(selIndex);var data=that.getData();var index=that.selectedIndex();var changeObj={prevIndex:-1,prevValue:"",prevText:"",prevData:{},index:-1,value:"",text:"",data:{}};var valueName="",textName=that.listcomboStruct.key;if(that.listcomboStruct.value==undefined)valueName=that.listcomboStruct.key;
else valueName=that.listcomboStruct.value;changeObj.prevIndex=prevIndex;if(prevData!=null){changeObj.prevData=prevData;changeObj.prevValue=prevData[valueName];changeObj.prevText=prevData[textName]}changeObj.index=index;changeObj.data=data;changeObj.value=data[valueName];changeObj.text=data[textName];that.onChange.call(undefined,undefined,changeObj)}else this._selectOption_core(selIndex)};this._selectOption_core=function(idx,flag){var movOption=this.optionsArr[idx];if(!movOption&&!(!flag&&idx==-1))return;
if(!flag)if(idx==-1){this._selOption=null;this._setText("");return}else{this._unSelectOption(idx);this._selOption=movOption;var data=movOption._data();this._setText(data[1])}else if(this._escOption)this._escOption._unselect_op(null);movOption._select_op(null);if(that.sColumn.length==0){var corr=movOption.content.offsetTop+movOption.content.offsetHeight-this.DOMlist.scrollTop-this.DOMlist.offsetHeight;if(corr>0)this.DOMlist.scrollTop+=corr;corr=this.DOMlist.scrollTop-movOption.content.offsetTop;if(corr>
0)this.DOMlist.scrollTop-=corr}};this._selectOption=function(e){(e||window.event).cancelBubble=true;var node=g_isIE?window.event.srcElement:e.target;var oThis=this;if(that.multiSelect){if(node.tagName=="INPUT"){var idx=parseInt(node.parentNode.id.split("-")[1]),checked=e.target.checked;if(checked==true){that.DumpData[idx]["ck"]=true;that.restoreData[that.DumpData[idx].idx]["ck"]=true}else{delete that.DumpData[idx]["ck"];delete that.restoreData[that.DumpData[idx].idx]["ck"]}}that._multiSelectText_()}else{if(that.sColumn.length>
0){if(node.className=="highlight")node=node.parentNode.parentNode.parentNode;if(node.tagName=="LI")node=node.parentNode.parentNode;if(node.tagName=="P")node=node.parentNode.parentNode.parentNode;jQuery(that.DOMlistPnl).children(".naw-combo-list").removeHighlight();for(var i=0,listLen=oThis.DOMlist.childNodes.length;i<listLen;i++)if(oThis.DOMlist.childNodes[i]==node)break;oThis._selectOption_core(i);oThis._closeAll();var data=oThis._selOption._data()[0];var nx=$(this.parentNode).getNX();if(nx!=undefined)$.publish("data.change",
{ref:nx.ref,data:data})}else{if(node.className=="highlight")node=node.parentNode;jQuery(that.DOMlistPnl).children(".naw-combo-list").removeHighlight();for(var i=0;i<oThis.DOMlist.childNodes.length;i++)if(oThis.DOMlist.childNodes[i]==node)break;oThis._selectOption_core(i);oThis._closeAll();var data=oThis._selOption._data()[0];var nx=$(this.parentNode).getNX();if(nx!=undefined)$.publish("data.change",{ref:nx.ref,data:data})}oThis.DOMelem_input.blur()}};this._setText=function(text){this.DOMelem_input.value=
text};this._unSelectOption=function(idx){if(this._selOption){this._selOption._deselect(idx);this._selOption._unselect_op(null);this._selOption=null}else if(this._blueOption)this._blueOption._unselect_op(null);if(this._escOption)this._escOption._unselect_op(null)};this.coreOption=function(){var sColumnLen=that.sColumn.length;this.value=null;this.text="";this.selected=false;this.css="";this.setValue=function(val){this.value=val||"";this.css="";this.content=null;comboObject._redrawOptions()};this.setText=
function(txt){this.text=txt||"";this.css="";this.content=null;comboObject._redrawOptions();var t_idx=comboObject._selectedIndex();if(t_idx!=-1)comboObject._selectOption_core(t_idx)};this.getValue=function(){return this.value};this.getText=function(){return this.text};this._select_op=function(_className){if(this.content){this.content.className=_className?_className:"naw-combo-selected";that.widgets._blueOption=this}};this._unselect_op=function(_className){if(this.content)this.content.className="";
var className=_className?_className:"naw-combo-selected";jQuery("."+className).removeClass(""+className)};this._list_unselect_op=function(){this.className="";if(that.widgets._selOption)that.widgets._selOption._unselect_op(null)};this._isHidden=function(){return this._render_op().style.display=="none"};this._deselect=function(idx){if(this.content)this._render_op()};this._setValue=function(attr){this.value=attr[1];var cText="";if(!$.isNull(that.listcomboStruct.mask))cText=$.valMask(attr[0][that.listcomboStruct.key],
that.listcomboStruct.mask);else if(!$.isNull(that.listcomboStruct.type))cText=$.valMask(attr[0][that.listcomboStruct.key],that.listcomboStruct.type);else cText=attr[0][that.listcomboStruct.key];this.text=cText||"";this.content=null};this._render_op=function(idx){if(!this.content){this.content=document.createElement("div");this.content.onmouseout=this._list_unselect_op;if(that.sColumn.length>0){var returnValue=this._ul_make(idx);var innerUl=returnValue[0];this.content.innerHTML=innerUl;this.content.style.width=
returnValue[1]+"px"}else if(this.text=="")this.content.innerHTML="&nbsp;";else this.content.innerHTML=this.text}return this.content};this._ul_make=function(idx){var data=that.DumpData[idx].dt;var sColumnOneWidth=80,sColumnIdx=0;var width=0;var innerStr='<ul style="display:inline;">';if(that.multiSelect){var checkBoxEditable=true;if(that.DumpData[idx].ckEdit===false)checkBoxEditable=false;innerStr+='<li id="'+that.renderTo+"-"+idx+'-multiSelect" style="width:30px;" ';innerStr+="class='listcombobox-multiselect-li' ";
innerStr+=" >";innerStr+="<input type='checkbox' ";if(checkBoxEditable===false)innerStr+="disabled='disabled' ";innerStr+=" /></li>";width+=31}for(var i=0;i<sColumnLen;i++){var columnName=that.sColumn[i];if(!naw.isNull(that.sColumnWidth[i]))sColumnOneWidth=parseInt(that.sColumnWidth[i]);innerStr+="<li id='"+that.renderTo+"-"+columnName+"' style='width:"+sColumnOneWidth+"px; ";if(that.sColumnAlign[i]!=undefined)innerStr+="text-align:"+that.sColumnAlign[i]+"; ";innerStr+="'>";width+=sColumnOneWidth+
1;var columnData="";if(columnName==that.listcomboStruct.key){var cText="";if(!$.isNull(that.listcomboStruct.mask))cText=$.valMask(data[columnName],that.listcomboStruct.mask);else if(!$.isNull(that.listcomboStruct.type))cText=$.valMask(data[columnName],that.listcomboStruct.type);else cText=data[columnName];columnData=cText}else if(data[columnName])columnData=data[columnName];else columnData="&nbsp;";innerStr+="<p>"+columnData+"</p>";innerStr+="</li>"}innerStr+="</ul>";return[innerStr,width]};this._data=
function(){return[this.value,this.text]}}},_multiSelectText_:function(){var self=this,len=self.DumpData.length;self.coreCombo();var $comboInput=jQuery(self.comboInput);var text=[],idx=[];for(var i=0;i<len;i++){var DumpData=self.DumpData[i];if(DumpData["ck"]){text.push(DumpData.dt[self.listcomboStruct.key]);idx.push(i)}}$comboInput.val(text.join(", "));$comboInput.data({"idx":idx})},_applyMask:function(argData,type,mask){var val="";if($.isNull(type))val=argData;else if(type=="date")if(!$.isNull(mask))val=
$.valMask(argData,mask);else val=$.valMask(argData,"date");else if(type=="time")if(!$.isNull(mask))val=$.valMask(argData,mask);else val=$.valMask(argData,"time");else if(type=="num")if(!$.isNull(mask))val=$.valNum(argData,mask);else val=$.valNum(argData,"#,###");else if(type=="ssn")if(!$.isNull(mask))val=$.valMask(argData,mask);else val=$.valMask(argData,"ssn");else if(type=="foreign")if(!$.isNull(mask))val=$.valMask(argData,mask);else val=$.valMask(argData,"foreign");else if(type=="brn")if(!$.isNull(mask))val=
$.valMask(argData,mask);else val=$.valMask(argData,"brn");else if(type=="lrn")if(!$.isNull(mask))val=$.valMask(argData,mask);else val=$.valMask(argData,"lrn");else if(type=="dateTime")if(!$.isNull(mask))val=$.valMask(argData,mask);else val=$.valMask(argData,"dateTime");else if(!$.isNull(mask))val=$.valMask(argData,mask);else val=argData;return val},selectedIndex:function(idx,argOption){var self=this,unCheck=false,extend=false;if(!this._isWidgets())return null;var len=self.DumpData.length;if(argOption){if(argOption.unCheck===
true){if(self.multiSelect===false)return false;unCheck=true;extend=true}if(argOption.extend===true){if(self.multiSelect===false)return false;extend=true}if(unCheck===true){var prevSelectedIndex=self.selectedIndex(),prevSelectedIndexLen=prevSelectedIndex.length;if(jQuery.isArray(idx)===false)idx=[idx];idx.sort(function(a,b){return a-b});idx=idx.slice(0);var idxIdx=0;for(var i=0;i<prevSelectedIndexLen;i++)if(prevSelectedIndex[i]==idx[idxIdx]){prevSelectedIndex.splice(i,1);i--;prevSelectedIndexLen--;
idxIdx++;if(idx[idxIdx]==undefined)break}idx=prevSelectedIndex}else if(extend===true){var prevSelectedIndex=self.selectedIndex();if(jQuery.isArray(idx)===false)idx=[idx];prevSelectedIndex=prevSelectedIndex.concat(idx);prevSelectedIndex.sort(function(a,b){return a-b});idx=prevSelectedIndex}}if(self.multiSelect){var $comboInput=jQuery(self.comboInput);if(idx!=undefined){for(var i=0;i<len;i++){var DumpData=self.DumpData[i];delete DumpData["ck"];delete self.restoreData[DumpData.idx]["ck"]}if(idx==-1){$comboInput.val("");
$comboInput.data({"idx":[]});var $inputCheck=jQuery("input",self.widgets.DOMlistPnl);$inputCheck.attr("checked",false)}else{var text=[];if(!jQuery.isArray(idx))idx=[idx];for(var i=0,idxLen=idx.length;i<idxLen;i++){var DumpData=self.DumpData[idx[i]];DumpData["ck"]=true;self.restoreData[DumpData.idx]["ck"]=true;text.push(DumpData.dt[self.listcomboStruct.key])}$comboInput.val(text.join(", "));$comboInput.data({"idx":idx});var $inputCheck=jQuery("input",self.comboList);$inputCheck.attr("checked",false);
for(var i=0,idxLen=idx.length;i<idxLen;i++){$inputCheck.eq(idx[i]).attr("checked",true);$inputCheck.eq(idx[i]).get(0).checked=true}var allCheckFlag=true;for(var i=0;i<len;i++){var DumpData=self.DumpData[i];if(DumpData["ck"]!==true){allCheckFlag=false;break}}jQuery("input",self.DOMlistTitle).prop("checked",allCheckFlag)}}else return $comboInput.data("idx")}else if(idx!=undefined)this.widgets._selectOption_core(idx);else return this.widgets._selectedIndex()},val:function(argData){var self=this;if(!this._isWidgets())return null;
var valueName="";if(argData==undefined)return false;if(self.listcomboStruct.value==undefined)valueName=self.listcomboStruct.key;else valueName=self.listcomboStruct.value;var idx=[];if(!self.multiSelect&&jQuery.isArray(argData))return false;if(!jQuery.isArray(argData))argData=[argData];for(var i=0,argDataLen=argData.length;i<argDataLen;i++)for(var j=0,len=self.DumpData.length;j<len;j++){var DumpData=self.DumpData[j],tmpData=DumpData.dt[valueName];if(tmpData==argData[i]){idx.push(j);break}}if(idx.length>
0){if(!self.multiSelect)idx=idx[0];self.selectedIndex(idx)}else self.selectedIndex(-1)},getData:function(keyName){var self=this;if(!this._isWidgets())return null;if(self.multiSelect){var $comboInput=jQuery(self.comboInput),idx=$comboInput.data("idx"),idxLen=idx.length;var returnData=[];for(var i=0;i<idxLen;i++){var rowIdx=idx[i];if(keyName!=undefined){var tmpValue=this.DumpData[rowIdx].dt[keyName];if(tmpValue==undefined)tmpValue="";returnData.push(tmpValue)}else returnData.push(JSON.parse(JSON.stringify(this.DumpData[rowIdx].dt)))}return returnData}else{var selIdx=
this.widgets._selectedIndex();if(selIdx==-1)return null;if(keyName!=undefined)if(!$.isNull(this.DumpData[selIdx].dt[keyName]))return this.DumpData[selIdx].dt[keyName];else return"";else return this.DumpData[selIdx].dt}},getAllData:function(pureData){if(!this._isWidgets())return null;var pureBool=true;if(arguments.length==1&&typeof pureData=="boolean")pureBool=pureData;if(pureBool){var resultData=[];for(var i=0,len=this.restoreData.length;i<len;i++)resultData.push(this.restoreData[i].dt);return resultData}else{var resultData=
[];for(var i=0,len=this.DumpData.length;i<len;i++)resultData.push(this.DumpData[i].dt);return resultData}},getOptionCnt:function(pureData){var returnValue=0;if(!this._isWidgets())return returnValue;var pureBool=true;if(arguments.length==1&&typeof pureData=="boolean")pureBool=pureData;if(pureBool)returnValue=this.restoreData.length;else returnValue=this.DumpData.length;return returnValue},getOptionData:function(index){if(!this._isWidgets())return null;if($.isNull(index))return null;if(!isNaN(index)&&
index>=0&&index<this.restoreData.length)return this.restoreData[index].dt;return[]},getInputText:function(){var self=this;if(!self._isWidgets())return null;return naw(self.widgets.DOMelem_input).val()},disable:function(bool){if(!this._isWidgets())return null;if(arguments.length==1&&typeof bool=="boolean")if(bool){jQuery(this.widgets.DOMelem_input).attr("disabled",true);jQuery(this.widgets.DOMelem_button).attr("disabled",true);jQuery(this.widgets.DOMParent).addClass("state-disabled")}else{jQuery(this.widgets.DOMelem_input).attr("disabled",
false);jQuery(this.widgets.DOMelem_button).attr("disabled",false);jQuery(this.widgets.DOMParent).removeClass("state-disabled")}else return false},setCheckEditable:function(argIdx,argBool){var self=this;if(!this._isWidgets()||self.multiSelect==false)return false;if(arguments.length<2)return false;var getIdx=argIdx,getBool=argBool,listSpan=self.widgets.DOMlist,$listSpan=jQuery(listSpan),list=$listSpan.children();if(getBool!==false)getBool=true;var checkBoxEditableFunc=function(idx){if(self.DumpData[idx]!=
undefined){var DumpData=self.DumpData[idx];if(getBool===false){DumpData.ckEdit=false;self.restoreData[DumpData.idx]["ckEdit"]=false}else{delete DumpData.ckEdit;delete self.restoreData[DumpData.idx]["ckEdit"]}var multiSelectLi=jQuery("#"+self.id+"-"+idx+"-multiSelect");if(multiSelectLi.length==0)return false;var checkBoxEle=multiSelectLi.find(":first-child");checkBoxEle.prop("disabled",!getBool)}};if(typeof getIdx=="number")if(getIdx==-1){for(var i=0,len=self.DumpData.length;i<len;i++)checkBoxEditableFunc(i);
var titleCheckboxEle=jQuery("input:checkbox",this.DOMlistTitle);if(titleCheckboxEle.length>0)titleCheckboxEle.prop("disabled",!getBool)}else checkBoxEditableFunc(getIdx);else if(jQuery.isArray(getIdx)==true){var getIdxLen=getIdx.length;for(var i=0;i<getIdxLen;i++)checkBoxEditableFunc(getIdx[i])}},addItem:function(argData){if(!this._isWidgets())return null;var rowData="";if(typeof argData.getJson=="function")rowData=argData.getJson();else rowData=argData;var len=0;if(typeof argData=="object"){len=
this.restoreData.length;if(typeof argData[0]=="object"){var rowDataLen=rowData.length;var j=0;while(j<rowDataLen){if($.isNull(rowData[j][this.listcomboStruct.key])){rowDataLen--;continue}this.restoreData[len+j]=new Object;this.restoreData[len+j].dt=rowData[j];this.restoreData[len+j].idx=len+j;j++}}else if(!$.isNull(rowData[this.listcomboStruct.key])){this.restoreData[len]=new Object;this.restoreData[len].dt=rowData;this.restoreData[len].idx=len}this.DumpData=this.restoreData.slice(0)}var x=new Array;
var prevSelectedIndex=this.selectedIndex();this.removeAll();for(var i=0;i<this.DumpData.length;i++)x[i]=[this.DumpData[i].dt,this.DumpData[i].idx];if(x.length>0)this.widgets._addOption_core(x);this.selectedIndex(prevSelectedIndex)},insertItem:function(argIdx,argData){var self=this,insertIdx=argIdx,insertData=argData,len=this.restoreData.length;if(typeof argData!="object")return false;if(!jQuery.isArray(insertData))insertData=[insertData];var insertDataLen=insertData.length;if(insertIdx>=len)insertIdx=
len;if(insertIdx<0)insertIdx=0;var $comboInput=jQuery(self.comboInput);for(var i=0;i<insertDataLen;i++)this.restoreData.splice(insertIdx+i,0,{dt:insertData[i]});for(var i=0;i<len+insertDataLen;i++)this.restoreData[i].idx=i;this.DumpData=this.restoreData.slice(0);this.addJSONData();if(self.multiSelect){var idx=[],text=[];for(var i=0,len=self.DumpData.length;i<len;i++){var DumpData=self.DumpData[i];if(DumpData["ck"]==true){idx.push(i);text.push(DumpData.dt[self.listcomboStruct.key])}}$comboInput.val(text.join(", "));
$comboInput.data({"idx":idx});var $inputCheck=jQuery("input",self.comboList);$inputCheck.attr("checked",false);for(var i=0,idxLen=idx.length;i<idxLen;i++){$inputCheck.eq(idx[i]).attr("checked",true);$inputCheck.eq(idx[i]).get(0).checked=true}}},removeItem:function(argDelIdx){this.removeOption(argDelIdx)},removeOption:function(argDelIdx){var self=this;var delIndex=argDelIdx;if(naw.isNull(delIndex)){this.removeAll();this.restoreData=[];this.DumpData=this.restoreData.slice(0);var $comboInput=jQuery(this.comboInput);
$comboInput.data({"idx":[]});return false}var dataLength=this.restoreData.length;if(dataLength==0)return false;if(!jQuery.isArray(delIndex))delIndex=[delIndex];delIndex.sort(function(a,b){return b-a});var delLength=delIndex.length;if(delIndex[0]>=dataLength)return false;if(self.multiSelect){var $comboInput=jQuery(self.comboInput),idx=$comboInput.data("idx");for(var i=0,idxLen=idx.length;i<idxLen;i++){var restoreData=self.restoreData[idx[i]];restoreData["ck"]=true}}for(var i=0;i<delLength;i++)this.restoreData.splice(delIndex[i],
1);for(var i=0;i<len-delLength;i++)this.restoreData[i].idx=i;this.DumpData=this.restoreData.slice(0);this.addJSONData();if(self.multiSelect){var idx=[],text=[];for(var i=0,len=self.DumpData.length;i<len;i++){var DumpData=self.DumpData[i];if(DumpData["ck"]==true){idx.push(i);text.push(DumpData.dt[self.listcomboStruct.key])}}$comboInput.val(text.join(", "));$comboInput.data({"idx":idx});var $inputCheck=jQuery("input",self.comboList);$inputCheck.attr("checked",false);for(var i=0,idxLen=idx.length;i<
idxLen;i++){$inputCheck.eq(idx[i]).attr("checked",true);$inputCheck.eq(idx[i]).get(0).checked=true}}},filterChange:function(argFilter){if(arguments.length==0)this.filter=null;if(argFilter!="first"&&argFilter!="like")return false;this.filter=argFilter},resetFilterData:function(){this.DumpData=this.restoreData.slice(0);this.addJSONData()},filterData:function(argKeyName,argFilter,argCompare){var len=this.restoreData.length;if(arguments.length==0){if(this.filterTmpCellData.length==0)return false;for(var i=
0;i<len;i++){var fIdx=this.restoreData[i].fIdx;this.filterTmpCellData[fIdx]=this.restoreData[i]}this.restoreData=this.filterTmpCellData.slice(0);for(var i=0,len=this.restoreData.length;i<len;i++)this.restoreData[i].idx=i;delete this.filterTmpCellData;this.filterTmpCellData=[]}else{if(len==0)return false;if(this.filterTmpCellData.length==0)this.filterTmpCellData=this.restoreData.slice(0);this.coreCombo();this._closeAll();var colIdx="",colLength=argKeyName.length;for(var j=0;j<colLength;j++)if(argKeyName[j]==
"&")colIdx+="&&";else if(argKeyName[j]=="|")colIdx+="||";else colIdx+=argKeyName[j];var colIdxArr=new Array,start=-1,sBool=false,colIdxPos=new Array;for(var i=0,colLength=colIdx.length;i<colLength;i++)if(colIdx[i].indexOf(")")!=-1||colIdx[i].indexOf("&")!=-1||colIdx[i].indexOf("|")!=-1||colIdx[i].indexOf("(")!=-1){if(sBool==true){sBool=false;colIdxPos[colIdxPos.length-1]+=i;colIdxArr[colIdxPos.length-1]=colIdx.substring(start,i)}}else if(sBool==false){sBool=true;start=i;colIdxPos.push(start+",");
if(i+1==colIdx.length&&sBool==true){colIdxPos[colIdxPos.length-1]+=i+1;colIdxArr[colIdxPos.length-1]=colIdx.substring(start,i+1)}}else if(i+1==colIdx.length){colIdxPos[colIdxPos.length-1]+=i+1;colIdxArr[colIdxPos.length-1]=colIdx.substring(start,i+1)}for(var i=0,rowIndex=0;i<len;i++){var stringCalc=colIdx;for(var j=colIdxArr.length-1;j>=0;j--){var tempStr="",argData="";if(colIdxArr[j].indexOf("/")!=-1){var leafNameList=colIdxArr[j].split("/");var tmpObj=this.restoreData[i].dt;for(var k=0;k<leafNameList.length;k++)tmpObj=
tmpObj[leafNameList[k]];argData=tmpObj}else argData=this.restoreData[i].dt[colIdxArr[j]];if(argFilter[j]=="include"){tempStr+='"'+argData+'"';tempStr+='.indexOf("'+argCompare[j]+'") != -1'}else if(argFilter[j]=="exclude"){tempStr+='"'+argData+'"';tempStr+='.indexOf("'+argCompare[j]+'") == -1'}else if(argFilter[j]=="equal"){tempStr+='"'+argData+'"';tempStr+='=="'+argCompare[j]+'"'}else if(argFilter[j]=="unequal"){tempStr+='"'+argData+'"';tempStr+='!="'+argCompare[j]+'"'}else{tempStr+=parseFloat(argData);
tempStr+=argFilter[j];tempStr+=parseFloat(argCompare[j])}var commaIdx=parseFloat(colIdxPos[j].indexOf(",")),temp1=stringCalc.substring(0,colIdxPos[j].substring(0,commaIdx)),temp2=stringCalc.substring(colIdxPos[j].substr(commaIdx+1),stringCalc.length);stringCalc=""+temp1+tempStr+temp2}if(eval(stringCalc)){this.restoreData[i].idx=rowIndex;rowIndex++;continue}else{this.restoreData.splice(i,1);i--;len--}}}this.DumpData=this.restoreData.slice(0);this.addJSONData()},sortData:function(keyName,sortName,sortType){var keyType=
"";if(arguments[2]&&arguments[2]=="num")keyType="num";if(this.restoreData.length==0)return false;if(sortName=="asc")if(keyType=="num")this.restoreData.sort(function(obj1,obj2){if(keyName.indexOf("/")!=-1){var leafNameList=keyName.split("/");var tmpObj1=obj1.dt;var tmpObj2=obj2.dt;for(var k=0;k<leafNameList.length;k++){tmpObj1=tmpObj1[leafNameList[k]];tmpObj2=tmpObj2[leafNameList[k]]}return parseInt(tmpObj1)-parseInt(tmpObj2)}else return parseInt(obj1.dt[keyName])-parseInt(obj2.dt[keyName])});else this.restoreData.sort(function(obj1,
obj2){if(keyName.indexOf("/")!=-1){var leafNameList=keyName.split("/");var tmpObj1=obj1.dt;var tmpObj2=obj2.dt;for(var k=0;k<leafNameList.length;k++){tmpObj1=tmpObj1[leafNameList[k]];tmpObj2=tmpObj2[leafNameList[k]]}if(tmpObj1<tmpObj2)return-1;else if(tmpObj1>tmpObj2)return 1;else return 0}else if(obj1.dt[keyName]<obj2.dt[keyName])return-1;else if(obj1.dt[keyName]>obj2.dt[keyName])return 1;else return 0});else if(keyType=="num")this.restoreData.sort(function(obj1,obj2){if(keyName.indexOf("/")!=-1){var leafNameList=
keyName.split("/");var tmpObj1=obj1.dt;var tmpObj2=obj2.dt;for(var k=0;k<leafNameList.length;k++){tmpObj1=tmpObj1[leafNameList[k]];tmpObj2=tmpObj2[leafNameList[k]]}return parseInt(tmpObj2)-parseInt(tmpObj1)}else return parseInt(obj2.dt[keyName])-parseInt(obj1.dt[keyName])});else this.restoreData.sort(function(obj1,obj2){if(keyName.indexOf("/")!=-1){var leafNameList=keyName.split("/");var tmpObj1=obj1.dt;var tmpObj2=obj2.dt;for(var k=0;k<leafNameList.length;k++){tmpObj1=tmpObj1[leafNameList[k]];tmpObj2=
tmpObj2[leafNameList[k]]}if(tmpObj1>tmpObj2)return-1;else if(tmpObj1<tmpObj2)return 1;else return 0}else if(obj1.dt[keyName]>obj2.dt[keyName])return-1;else if(obj1.dt[keyName]<obj2.dt[keyName])return 1;else return 0});this.DumpData=this.restoreData.slice(0);this.addJSONData()},addTitle:function(argData){var self=this,sColumnLen=self.sColumn.length;self.DOMlistTitle.firstChild.innerHTML="";if(jQuery.isArray(argData))self.title=argData;else if(sColumnLen==0)self.title=[""];else{self.title=[];for(var i=
0;i<sColumnLen;i++)self.title.push("")}var titleStr="";if(sColumnLen>0&&self.multiSelect==true)titleStr+="<li style='width:30px;'</li>";for(var i=0,titleLen=self.title.length;i<titleLen;i++){if(sColumnLen==0&&i==1)break;var sColumnOneWidth=80;if(self.sColumnWidth[i]!=undefined)sColumnOneWidth=parseInt(self.sColumnWidth[i]);titleStr+="<li style='";if(sColumnLen)titleStr+="width:"+sColumnOneWidth+"px;";titleStr+="'>";titleStr+=self.title[i];titleStr+="</li>"}jQuery(self.DOMlistTitle.firstChild).append(titleStr);
jQuery(self.DOMlistTitle).removeClass("state-hide")},setTitle:function(argIndex,argData){var self=this,titleLen=self.title.length;if(titleLen==0||titleLen<=argIndex||argIndex<0)return false;argIndex=parseInt(argIndex);self.title[argIndex]=argData;var tmpPlusIdx=0;if(self.multiSelect)tmpPlusIdx=1;jQuery(this.DOMlistTitle.firstChild).children("li").eq(argIndex+tmpPlusIdx).text(argData)},removeTitle:function(){var self=this;self.title=[];jQuery(this.DOMlistTitle.firstChild).children("li").remove();jQuery(this.DOMlistTitle).addClass("state-hide")},
focus:function(){var self=this;self.widgets.DOMelem_input.focus()},closeListPnl:function(){var self=this;self._closeListPnl_(self,window.event)}});$._addWidget("listcombobox",naw.widget.listcombobox)})(naw);
jQuery.fn.highlight=function(pat,filter,struct){var nodeNum=0;var nodeInNum=0;var lastPos=0;var expCnt1=0;var re=/[\,\-]/;function innerHighlight(node,pat){var skip=0;if(node.nodeType==3){if((struct.type=="date"||struct.type=="num")&&pat.length>1){var pos=-1;if(struct.type=="num")pos=naw.replace(node.data.toString(),",","").toUpperCase().indexOf(pat);if(struct.type=="date")pos=naw.replace(node.data.toString(),"-","").toUpperCase().indexOf(pat);if(pos>=0){var spannode=document.createElement("span");
var i=0;var j=0;expCnt1=0;var expCnt2=0;lastPos+=pos+pat.length;while(i<pos){if(!naw.isNull(node.data[j].match(re))&&node.data[j].match(re).length>0){expCnt1++;j++;continue}j++;i++;if(i==pos)if(!naw.isNull(node.data[j].match(re))&&node.data[j].match(re).length>0){expCnt1++;j++;break}}i=0;while(i<pat.length){if(!naw.isNull(node.data[j].match(re))&&node.data[j].match(re).length>0){expCnt2++;j++;continue}j++;i++}var str=node.data.substring(0,lastPos+expCnt1);spannode.className="highlight";var middlebit=
node.splitText(pos+expCnt1);var endbit=middlebit.splitText(pat.length+expCnt2);var middleclone=middlebit.cloneNode(true);spannode.appendChild(middleclone);middlebit.parentNode.replaceChild(spannode,middlebit);skip=1}}else{var pos=node.data.toUpperCase().indexOf(pat);if(pos>=0){var spannode=document.createElement("span");spannode.className="highlight";var middlebit=node.splitText(pos);var endbit=middlebit.splitText(pat.length);var middleclone=middlebit.cloneNode(true);spannode.appendChild(middleclone);
middlebit.parentNode.replaceChild(spannode,middlebit);skip=1}}if(filter=="first")return;nodeInNum++}else if(node.nodeType==1&&node.childNodes&&!/(script|style)/i.test(node.tagName)){for(var i=0;i<node.childNodes.length;++i)i+=innerHighlight(node.childNodes[i],pat);nodeNum++;nodeInNum=0;lastPos=0;expCnt1=0}return skip}return this.length&&pat&&pat.length?this.each(function(){innerHighlight(this,pat.toUpperCase())}):this};
jQuery.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;with(this.parentNode){replaceChild(this.firstChild,this);normalize()}}).end()};