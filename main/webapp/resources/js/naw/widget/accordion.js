(function(d){naw.namespace("accordion");naw.accordion={options:{header:"h3.accordion-header",content:"div.accordion-content",event:"click",active:0,animated:"slide",autoHeight:!1,height:void 0,fillSpace:!1,collapsible:!1,numbering:!1,sortable:!1,onchange:null,onbeforechange:null,clearStyle:!1},animations:{slide:function(a,c){a=d.extend({easing:"swing",duration:naw.config.accordion&&!naw.isNull(naw.config.accordion.duration)?naw.config.accordion.duration:0},a,c);if(a.toHide.size())if(a.toShow.size()){var b=
a.toShow.css("overflow"),e=0,f={},g={},l,k=a.toShow;l=k[0].style.width;k.width(parseInt(k.parent().width(),10)-parseInt(k.css("paddingLeft"),10)-parseInt(k.css("paddingRight"),10)-(parseInt(k.css("borderLeftWidth"),10)||0)-(parseInt(k.css("borderRightWidth"),10)||0));d.each(["height"],function(c,b){g[b]="hide";var e=(""+d.css(a.toShow[0],b)).match(/^([\d+-.]+)(.*)$/);f[b]={value:e[1],unit:e[2]||"px"}});a.toShow.css({height:0,overflow:"hidden"}).show();a.toHide.filter(":hidden").each(a.complete).end().filter(":visible").animate(g,
{step:function(c,b){"height"==b.prop&&(e=0===b.end-b.start?0:(b.now-b.start)/(b.end-b.start));a.toShow[0].style[b.prop]=e*f[b.prop].value+f[b.prop].unit},duration:a.duration,easing:a.easing,complete:function(){a.autoHeight||a.toShow.css("height","");a.toShow.css({width:l,overflow:b});a.complete()}})}else a.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},a);else a.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},a)},bounceslide:function(a){this.slide(a,{easing:a.down?
"easeOutBounce":"swing",duration:a.down?100:20})}}};var p=naw.plugin.Base.extend({init:function(a,c){var b=this;b.setName("accordion");b._super("accordion");naw.subscribe("theme.change",function(a){b.changeTheme(a.themeName,a.themeBasePath)});b.running=0;void 0!=c.height?a.height(c.height):a.height("");b.options=c;b.element=a.removeClass("x-numbering").addClass(c.numbering?"x-numbering":"");var e=a.attr("id")?a.attr("id"):"pAccordion"+Math.floor(11*Math.random());b.id=e;b.headers=b.element.find(c.header);
b.contents=b.element.find(c.content);b.headers.off();b.blinkArr=[];b.headers.each(function(a){d(this).removeClass("state-current").removeClass("x-corner-top").removeAttr("tabindex");d(this).addClass("x-corner-all").hover(function(a){c.disabled||d(this).not(".state-disabled").not(".state-current").addClass("state-hover")},function(a){c.disabled||d(this).not(".state-disabled").removeClass("state-hover")}).children("a").attr("href","#javascript:void(0)").end().children(".buttonset").hide().end();0==
d("#"+e+"-errButton-"+a).length&&(a=jQuery("<button type='button' class='accordion-err-button state-blink state-hide' id='"+e+"-errButton-"+a+"'></button>"),d(this).append(a));b.blinkArr.push(void 0)});b.headers.next().each(function(a){d(this).removeClass("state-current").css("display","");d(this).addClass("x-corner-bottom").attr("data-index",a)});c.collapsible&&-1==c.active?b.active=d([]):(b.active=b._findActive(b.active||c.active).addClass("state-current").toggleClass("x-corner-all").toggleClass("x-corner-top").children("span.bettonset").show().end(),
b.active.next().addClass("state-current"));b.headers.each(function(){"DIV"!=this.parentNode.tagName||jQuery(this.parentNode).hasClass("accordion-pnl")||d(this).unwrap()});b._eventBind();b._createIcons();b._addonSorable();b.resize();c.event&&b.headers.bind(c.event,function(a){b._clickHandler.call(b,a,this);a.preventDefault()});b.contents.unbind("errFieldEvent");b.contents.bind("errFieldEvent",function(a,c){var f=jQuery(this).index()/2-.5,d=b.headers.eq(f),g=jQuery("#"+e+"-errButton-"+f),h=g.prev();
g.removeClass("state-hide");h.addClass("accordion-err-a state-blink");var n=void 0;"msie"==naw.agent.browser&&10>parseInt(naw.agent.version)&&void 0==b.blinkArr[f]&&(n=setInterval(function(){g.fadeToggle(200);h.fadeToggle(200)},400),b.blinkArr[f]=n);f=d.data("errInfo");void 0==f&&(f={});f[a.target.id]=c;d.data("errInfo",f)});this.isComplete&&naw.publish("window.resize",b.active.next().attr("id"));b.collapsible||naw.subscribe("window.resize",function(){index=b.options.active;if(0<b.element.width()&&
0<b.element.height()){var a=b._findActive(index)[0],a=jQuery(a).next();if(0==a.width()){a[0].style.width="";a[0].style.height="";for(var a=0,c=b.element[0].childNodes.length;a<c;a+=2)2*index+1!=a+1&&b.element[0].childNodes[a+1]&&(b.element[0].childNodes[a+1].style.display="none")}}});(c.autoHeight||c.fillSpace)&&naw.subscribe("grid.createComplete",function(a){b.resize()})},_init:function(){var a=this,c=a.options;accordionId=a.id;a.headers=a.element.find(c.header);a.contents=a.element.find(c.content);
a.headers.off();a.blinkArr=[];a.headers.each(function(b){d(this).removeClass("state-current").removeClass("x-corner-top").removeAttr("tabindex");d(this).addClass("x-corner-all").hover(function(a){c.disabled||d(this).not(".state-disabled").not(".state-current").addClass("state-hover")},function(a){c.disabled||d(this).not(".state-disabled").removeClass("state-hover")}).children("a").attr("href","#javascript:void(0)").end().children(".buttonset").hide().end();0==d("#"+accordionId+"-errButton-"+b).length&&
(b=jQuery("<button type='button' class='accordion-err-button state-blink state-hide' id='"+accordionId+"-errButton-"+b+"'></button>"),d(this).append(b));a.blinkArr.push(void 0)});a.headers.next().each(function(a){d(this).removeClass("state-current").css("display","");d(this).addClass("x-corner-bottom").attr("data-index",a)});c.collapsible&&-1==c.active?a.active=d([]):(a.active=a._findActive(a.active||c.active).addClass("state-current").toggleClass("x-corner-all").toggleClass("x-corner-top").children("span.bettonset").show().end(),
a.active.next().addClass("state-current"));a.headers.each(function(){"DIV"!=this.parentNode.tagName||jQuery(this.parentNode).hasClass("accordion-pnl")||d(this).unwrap()});a._eventBind();a._createIcons();a._addonSorable();a.resize();c.event&&a.headers.bind(c.event,function(b){a._clickHandler.call(a,b,this);b.preventDefault()});a.contents.unbind("errFieldEvent");a.contents.bind("errFieldEvent",function(b,c){var f=jQuery(this).index()/2-.5,d=a.headers.eq(f),e=jQuery("#"+accordionId+"-errButton-"+f),
k=e.prev();e.removeClass("state-hide");k.addClass("accordion-err-a state-blink");var m=void 0;"msie"==naw.agent.browser&&10>parseInt(naw.agent.version)&&void 0==a.blinkArr[f]&&(m=setInterval(function(){e.fadeToggle(200);k.fadeToggle(200)},400),a.blinkArr[f]=m);f=d.data("errInfo");void 0==f&&(f={});f[b.target.id]=c;d.data("errInfo",f)})},_eventBind:function(){for(var a=["click"],c=0,b=a.length;c<b;c++){var e=a[c];this[e]=function(a,c){return function(b){a.options["on"+c.substring(0,1).toUpperCase()+
c.substr(1)]=b}}(this,e)}},_createIcons:function(){this.headers.each(function(){"SPAN"==this.firstChild.tagName&&"x-icon"==this.firstChild.className&&d(this.firstChild).remove()});d("<span></span>").addClass("x-icon").prependTo(this.headers);this.headers.children("span.x-icon").each(function(a){d(this).addClass("x-n"+ ++a)})},_addonSorable:function(){var a=this.element,c=this.options;!c.numbering&&c.sortable&&naw.loadWidget("sortable",function(){a.find(c.header).each(function(b){b=c.header+":eq("+
b+")";a.find(b+", "+b+" + "+c.content).wrapAll("<div></div>").end()});naw(a).sortable({handle:"h3",opacity:.6,axis:"y"})})},_findActive:function(a){return a?"number"===typeof a?this.headers.filter(":eq("+a+")"):this.headers.not(this.headers.not(a)):!1===a?d([]):this.headers.filter(":eq(0)")},_clickHandler:function(a,c){var b=this.options;if(!b.disabled){if(this.options.sortable){if(jQuery(c).parent().hasClass("state-disabled"))return}else if(jQuery(c).hasClass("state-disabled"))return;var e=d(a.currentTarget||
c),f=e[0]===this.active[0];b.active=b.collapsible&&f?!1:this.headers.index(e);if("function"==typeof b.onClick&&"number"==typeof b.active)b.onClick(b.active);if(!(this.running||!b.collapsible&&f)){this.active.removeClass("state-current x-corner-top").addClass("x-corner-all").children(".buttonset").hide().end();f||(e.removeClass("x-corner-all").addClass("state-current x-corner-top").removeClass("state-hover").children(".buttonset").show().end(),e.next().addClass("state-current"));var g=e.next(),l=this.active.next(),
k={options:b,newHeader:f&&b.collapsible?d([]):e,oldHeader:this.active,newContent:f&&b.collapsible?d([]):g,oldContent:l},m=this.headers.index(this.active[0])>this.headers.index(e[0]);this.active=f?d([]):e;this._toggle(g,l,k,f,m);if(this.active&&(e=this.headers.eq(b.active).data("errInfo"),void 0!=e)){for(var h in e)naw("#"+h).errField(e[h]);h=jQuery("#"+this.id+"-errButton-"+b.active);e=h.prev();this.headers.eq(b.active).removeData("errInfo");f=this.blinkArr[b.active];void 0!=f&&(clearInterval(f),
h.stop().fadeTo(200,1),e.stop().fadeTo(200,1),this.blinkArr[b.active]=void 0);h.addClass("state-hide");h.hide();e.removeClass("accordion-err-a state-blink")}}}},_toggle:function(a,c,b,e,f){var g=this,l=g.options;g.toShow=a;g.toHide=c;g.data=b;var k=function(){if(g)return g._completed.apply(g,arguments)};g._trigger("changestart",null,g.data);g.running=0===c.size()?a.size():c.size();if(l.animated){b={};b=l.collapsible&&e?{toShow:d([]),toHide:c,complete:k,down:f,autoHeight:l.autoHeight||l.fillSpace}:
{toShow:a,toHide:c,complete:k,down:f,autoHeight:l.autoHeight||l.fillSpace};e=naw.accordion.animations;var m=l.duration,h=l.animated;!h||e[h]||d.easing[h]||(h="slide");e[h]||(e[h]=function(a){this.slide(a,{easing:h,duration:m||700})});e[h](b)}else l.collapsible&&e?a.toggle():(c.hide(),a.show()),k(!0);c.prev().attr({tabIndex:-1}).blur();a.prev().attr({tabIndex:0}).focus()},_completed:function(a){this.running=a?0:--this.running;this.running||(this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",
overflow:""}),this.toHide.removeClass("state-current"),naw.publish("window.resize",this.toShow.attr("id")))},_trigger:function(a,c,b){var e=this.options[a];c=d.Event(c);b=b||{};c.type||(c.type=a);this.element.trigger(c,b);return!(d.isFunction(e)&&!1===e.call(this,c,b)||c.isDefaultPrevented())},resize:function(){var a=this.options,c;if(a.fillSpace){var b=this.element.parent().css("overflow");"msie"==naw.agent.browser&&(b=this.element.parent().css("overflow"),this.element.parent().css("overflow","hidden"));
void 0!=a.height?(c=this.element.height(),this.headers.each(function(){c-=d(this).outerHeight(!0)}),this.headers.next().each(function(){d(this).height(Math.max(0,c))}).css("overflow","auto")):(c=this.element.parent().height(),jQuery(this.element).siblings().each(function(){c-=jQuery(this).height()}),"msie"==naw.agent.browser&&this.element.parent().css("overflow",b),this.headers.each(function(){c-=d(this).outerHeight(!0)}),this.headers.next().each(function(){d(this).height(Math.max(0,c-d(this).innerHeight()+
d(this).height()))}).css("overflow","auto"))}else a.autoHeight&&(c=0,this.headers.next().each(function(){c=Math.max(c,d(this).height("").height())}).height(c));return this},activate:function(a){this.expand(a)},expand:function(a){if("number"==typeof this.options.active&&this.options.active==a)return!1;this.options.active=a;a=this._findActive(a)[0];this._clickHandler({target:a},a)},collapse:function(){if(!this.options.collapsible)return!1;var a=this.options.active;if("boolean"==typeof a&&0==a)return!1;
a=this._findActive(a)[0];this._clickHandler({target:a},a)},insertContents:function(a,c,b){var e=this.element,d=e.children();if("number"!=typeof c)return!1;b=jQuery("<h3 class='accordion-header'><a href='#'>"+b+"</a></h3>");0==d.length?e.append(b):0<d.eq(2*c).length?d.eq(2*c).before(b):e.append(b);a=jQuery("<div id='"+a+"' class='accordion-content' style='display:none;' ></div>");b.after(a);this._init();return!0},removeContents:function(a){var c=this.element.children();if("number"==typeof a&&this.getCurrentSection()!=
a&&0!=c.length&&0<c.eq(2*a).length)c.eq(2*a).remove(),c.eq(2*a).remove();else return!1;this._init();return!0},getCurrentSection:function(){var a=-1,c=this.active;0<c.length&&(a=c.index()/2);return a},disabledSection:function(a){var c=[];jQuery.isArray(a)?c=c.concat(a):c.push(a);for(i in c)this.options.sortable?this.headers.parent().eq(c[i]).addClass("state-disabled"):this.headers.eq(c[i]).addClass("state-disabled");return this},enabledSection:function(a){var c=[];jQuery.isArray(a)?c=c.concat(a):c.push(a);
for(i in c)this.options.sortable?this.headers.parent().eq(c[i]).removeClass("state-disabled"):this.headers.eq(c[i]).removeClass("state-disabled");return this},hideSection:function(a){this.options.sortable?naw(this.headers.parent().eq(a)).hide():naw(this.headers.eq(a)).hide();return this},showSection:function(a){this.options.sortable?naw(this.headers.parent().eq(a)).show():naw(this.headers.eq(a)).show();return this},removeErrDisplay:function(a){var c=this,b=function(a){var b=c.headers.eq(a).data("errInfo");
if(void 0!=b){for(var d in b)naw("#"+d).errField(b[d]);b=jQuery("#"+c.id+"-errButton-"+a);d=b.prev();c.headers.eq(a).removeData("errInfo");var e=c.blinkArr[a];void 0!=e&&(clearInterval(e),b.stop().fadeTo(200,1),d.stop().fadeTo(200,1),c.blinkArr[a]=void 0);b.addClass("state-hide");b.hide();d.removeClass("accordion-err-a state-blink")}};if(void 0==a){a=0;for(var d=c.headers.length;a<d;a++)b(a)}else isNaN(a)||b(parseInt(a))},_setOption:function(a,c){"active"==a&&this.activate(c);"icons"==a&&(this._destroyIcons(),
c&&this._createIcons());if("disabled"==a)this.headers.add(this.headers.next())[c?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")}});naw._addFunction(!0,{accordion:function(a){var c=this.jq.get(0).widget;c||(a||(a={}),a=d.extend({},naw.accordion.options,a),c=new p(this.jq,a),this.jq.get(0).widget=c);return c}})})(jQuery);