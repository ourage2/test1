(function(g,e){function l(b,a,c,d){var e=b.css("float"),f="x"===c||"left"===e||"right"===e?"left":"top";c=b.offset()[f];f=a.offset()[f];return"right"==e?"next"==d?c<=f-2:c>=f+2:"next"===d?c+b.innerHeight()>=f+a.innerHeight():c<=f+2}function m(b,a){0==a.length?b.parent().append(b):b.insertBefore(a);b.css({top:"0px",left:"0px"})}var k=null,h=null,n=naw.extend({init:function(b,a){this.options=a;null==k?(k=h=b,this.nextContainer=this.previousContainer=null):(this.previousContainer=h,this.previousContainer.data("sort").nextContainer=
b,h=h.data("sort").nextContainer=b);a&&a.axis&&(this.axis=a&&a.axis?a.axis:"y");this.onDragOver=new Function;this.onDragOut=new Function;var c=b.children();a.exclude&&(c=c.not(a.exclude));for(var d=0;d<c.length;d++)c.data("parentNode",b),e(c[d]).attr("sortidx",d),a.items=c,this._makeDragable(c[d],a)},_makeDragable:function(b,a){var c=naw(b,!0);c.data("isOutside",!1);c.draggable(e.extend({},a,{start:this.onDragStart,drag:this.onDrag,stop:this.onDragEnd,isSortable:!0,revert:!0}))},onDragStart:function(b,
a,c,d){for(a=b=e(this).data("parentNode");null!=a;)a.data("northwest",g.northwestOffset(a.get(0),!0)),a.data("southeast",g.southeastOffset(a.get(0),!0)),a=a.data("sort").nextContainer;b.data("sort").options.start&&b.data("sort").options.start.call(this)},onDrag:function(b,a,c,d){b=e(this).data("parentNode");if(this.data("isOutside")){for(a=k;null!=a;){if(c.inside(a.data("northwest"),a.data("southeast"))||d.inside(a.data("northwest"),a.data("southeast"))){a.data("sort").onDragOver();this.data("isOutside",
!1);a.append(this);break}a=a.data("sort").nextContainer}if(this.data("isOutside"))return}else c.inside(b.data("northwest"),b.data("southeast"))||d.inside(b.data("northwest"),b.data("southeast"))||g.insideXY(c.x,d.y,b.data("northwest"),b.data("southeast"))||g.insideXY(d.x,c.y,b.data("northwest"),b.data("southeast"));c=this;d=c.next();for(b=b.data("sort").axis;0!=d.length&&l(this,d,b,"next");)c=d,d=c.next();if(this!=c)m(this,d);else{c=this;for(d=c.prev();0!=d.length&&l(this,d,b,"prev");)c=d,d=c.prev();
this!=c&&m(this,c)}},onDragEnd:function(b,a,c,d){b=e(this).data("parentNode");this.data("isOutside")&&(a=this.data("sibling"),0<a.length&&this.insertAfter(a),this.data("isOutside",!1));this.css({top:"0px",left:"0px"});b.data("sort").options.start&&b.data("sort").options.stop.call(this)}});naw._addFunction(!0,{sortable:function(b,a){if("string"===typeof b)return this.draggable(b,a),this;options=e.extend({axis:"xy",disable:!1,opacity:.75},b);this.foreach(function(){var a=e(this),b=a.data("sort");b||
(b=new n(a,options),a.data("sort",b))});return this}})})(naw.ui.coordinates,jQuery);